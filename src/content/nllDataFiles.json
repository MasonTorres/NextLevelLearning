[
 { "file": "CheatSheet", "path": "./json/CheatSheet.json", "data": {
  "title": "Cheat Sheet",
  "path": "/linux/cheat-sheet",
  "section": "Linux",
  "subSection": "",
  "description": "Use this cheat sheet to brush up on your Linux commands and for all those Linux commands you can't quite remember!",
  "data": [
    {
      "section": 1,
      "title": "General",
      "description": "General commands",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Directories"
            },
            {
              "Type": "Description",
              "Value": "/root - root user home directory"
            },
            {
              "Type": "Description",
              "Value": "/home - every user home directory"
            },
            {
              "Type": "Description",
              "Value": "/lib - \"c\" libraries used by programs and kernel"
            },
            {
              "Type": "Description",
              "Value": "/dev - device drivers/files"
            },
            {
              "Type": "Description",
              "Value": "/usr - user programs and utilities (binaries, docs, libraries, include files, etc.)"
            },
            {
              "Type": "Description",
              "Value": "/bin - OS essential binaries (ls, cp, mv, etc.)"
            },
            {
              "Type": "Description",
              "Value": "/etc - system configuration files, includes startup scripts"
            },
            {
              "Type": "Description",
              "Value": "/mnt - mount point for external file systems"
            },
            {
              "Type": "Description",
              "Value": "/var - variable data (mail and printer spools, log files, lock files, etc.)"
            },
            {
              "Type": "Description",
              "Value": "/tmp - temporary files"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "No output"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Kernel version"
            },
            {
              "Type": "Description",
              "Value": "Check kernal version / system information"
            },
            {
              "Type": "Code",
              "Value": "uname -a"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "Linux ROCKY-01 5.14.0-162.12.1.el9_1.0.2.x86_64 #1 SMP PREEMPT_DYNAMIC Mon Jan 30 22:14:42 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Process ID"
            },
            {
              "Type": "Description",
              "Value": "Check process id"
            },
            {
              "Type": "Code",
              "Value": "ps aux | grep mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "No MDATP process is found"
            },
            {
              "Type": "Code",
              "Value": "labmin      4500  0.0  0.0   3876  2084 pts/0    S+   04:06   0:00 grep --color=auto mdatp"
            },
            {
              "Type": "Description",
              "Value": "MDATP process is found"
            },
            {
              "Type": "Code",
              "Value": "root         714  0.2  7.4 1177124 143848 ?      Ssl  03:18   0:07 /opt/microsoft/mdatp/sbin/wdavdaemon\r\n              root         927  0.1  3.5 862736 67892 ?        Sl   03:18   0:05 /opt/microsoft/mdatp/sbin/wdavdaemon edr 12 11 --log_level info\r\n              root        1097  0.0  0.8 296188 16804 ?        Sl   03:18   0:00 /opt/microsoft/mdatp/sbin/telemetryd_v2 32\"\r\n              root        1298  0.3  6.6 3035812 128692 ?      Sl   03:18   0:11 /opt/microsoft/mdatp/sbin/wdavdaemon_network_protection network_protection 46 45\r\n              root        1729  0.0  0.5 795992  9920 ?        S<l  03:18   0:00 /opt/microsoft/mdatp/sbin/mdatp_audisp_plugin\r\n              mdatp       1838  0.9 10.2 917836 199152 ?       Sl   03:18   0:27 /opt/microsoft/mdatp/sbin/wdavdaemon unprivileged 61 264 266 268 57 --log_level info\r\n              labmin      2816  0.0  0.0  12144  1108 pts/0    R+   04:07   0:00 grep --color=auto mdatp"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Kill Process"
            },
            {
              "Type": "Description",
              "Value": "Kill Process"
            },
            {
              "Type": "Code",
              "Value": "kill -9 9112"
            },
            {
              "Type": "Note",
              "Value": "Signal numbers are not portable, while signal names are. Check signal command for more information by running \"kill -l\""
            },
            {
              "Type": "Code",
              "Value": "kill -l"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "[1]+  Stopped                 less ~/.bash_history"
            },
            {
              "Type": "Title",
              "Value": "Output sample - kill -l"
            },
            {
              "Type": "Code",
              "Value": " 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP\r\n 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1\r\n11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM\r\n16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\r\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ\r\n26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR\r\n31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3\r\n38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\r\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13\r\n48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12\r\n53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7\r\n58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\r\n63) SIGRTMAX-1  64) SIGRTMAX"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Display Linux processes"
            },
            {
              "Type": "Description",
              "Value": "Display Linux processes"
            },
            {
              "Type": "Code",
              "Value": "top"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "top - 04:21:58 up  1:03,  1 user,  load average: 0.00, 0.04, 0.07\r\nTasks: 117 total,   2 running, 115 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s):  0.3 us,  0.0 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\r\nMiB Mem :   1893.9 total,    593.8 free,    619.5 used,    680.6 buff/cache\r\nMiB Swap:      0.0 total,      0.0 free,      0.0 used.   1056.9 avail Mem\r\n\r\n    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND\r\n   1397 root      20   0  438824  29240  11544 S   0.3   1.5   0:08.41 python3\r\n   1838 mdatp     20   0  926032 200348  58188 S   0.3  10.3   0:33.88 wdavdaemon\r\n      1 root      20   0  175328  13700   8976 S   0.0   0.7   0:02.33 systemd\r\n      2 root      20   0       0      0      0 S   0.0   0.0   0:00.00 kthreadd\r\n      3 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_gp\r\n      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_par_gp\r\n      5 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 slub_flushwq\r\n      7 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0H-events_highpri\r\n      9 root      20   0       0      0      0 I   0.0   0.0   0:00.08 kworker/u2:0-events_unbound\r\n     10 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 mm_percpu_wq\r\n     11 root      20   0       0      0      0 S   0.0   0.0   0:00.00 rcu_tasks_rude_\r\n     12 root      20   0       0      0      0 S   0.0   0.0   0:00.00 rcu_tasks_trace\r\n     13 root      20   0       0      0      0 S   0.0   0.0   0:00.09 ksoftirqd/0\r\n     14 root      20   0       0      0      0 I   0.0   0.0   0:00.15 rcu_sched"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "List of open files"
            },
            {
              "Type": "Description",
              "Value": "List of open files"
            },
            {
              "Type": "Code",
              "Value": "lsof | grep mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "[labmin@CENTSOS-02 ~]$ sudo lsof | grep mdatp | grep /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714                          root  cwd       DIR                8,2     4096    4347690 /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714                          root  txt       REG                8,2    16384    4347703 /opt/microsoft/mdatp/sbin/wdavdaemon\r\nwdavdaemo  714  842 wdavdaemo           root  cwd       DIR                8,2     4096    4347690 /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714  842 wdavdaemo           root  txt       REG                8,2    16384    4347703 /opt/microsoft/mdatp/sbin/wdavdaemon\r\nwdavdaemo  714  843 wdavdaemo           root  cwd       DIR                8,2     4096    4347690 /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714  843 wdavdaemo           root  txt       REG                8,2    16384    4347703 /opt/microsoft/mdatp/sbin/wdavdaemon\r\nwdavdaemo  714  844 wdavdaemo           root  cwd       DIR                8,2     4096    4347690 /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714  844 wdavdaemo           root  txt       REG                8,2    16384    4347703 /opt/microsoft/mdatp/sbin/wdavdaemon\r\nwdavdaemo  714  845 wdavdaemo           root  cwd       DIR                8,2     4096    4347690 /opt/microsoft/mdatp/sbin\r\nwdavdaemo  714  845 wdavdaemo           root  txt       REG                8,2    16384    4347703 /opt/microsoft/mdatp/sbin/wdavdaemon"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Display CPU information"
            },
            {
              "Type": "Description",
              "Value": "Display CPU information"
            },
            {
              "Type": "Code",
              "Value": "cat /proc/cpuinfo"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "processor       : 0\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 79\r\nmodel name      : Intel(R) Xeon(R) CPU E5-2673 v4 @ 2.30GHz\r\nstepping        : 1\r\nmicrocode       : 0xffffffff\r\ncpu MHz         : 2294.686\r\ncache size      : 51200 KB\r\nphysical id     : 0\r\nsiblings        : 1\r\ncore id         : 0\r\ncpu cores       : 1\r\napicid          : 0\r\ninitial apicid  : 0\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 20\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave\r\navx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm rdseed adx smap xsaveopt md_clear\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit mmio_stale_data\r\nbogomips        : 4589.37\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 46 bits physical, 48 bits virtual\r\npower management:"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "CPU free memory"
            },
            {
              "Type": "Description",
              "Value": "Display amount of free and used memory in the system"
            },
            {
              "Type": "Code",
              "Value": "free -h"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "total        used        free      shared  buff/cache   available\r\nMem:          1.8Gi       651Mi       488Mi       8.0Mi       753Mi       989Mi\r\nSwap:            0B          0B          0B"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Find file by name"
            },
            {
              "Type": "Code",
              "Value": "find /home/labmin -name M*"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "/home/labmin/Master.txt"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Find files by size"
            },
            {
              "Type": "Code",
              "Value": "find /home/labmin -size +8k"
            },
            {
              "Type": "Code",
              "Value": "find /home/labmin -size +100M"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "/home/labmin/libxcrypt-4.4.18-3.el9.i686.rpm\r\n/home/labmin/.puppetlabs/opt/puppet/cache/state/last_run_report.yaml\r\n/home/labmin/installation.log"
            },
            {
              "Type": "Code",
              "Value": ""
            },
            {
              "Type": "Note",
              "Value": "Empty output becuase no files of +100M are found"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Compare two files"
            },
            {
              "Type": "Code",
              "Value": "diff MicrosoftDefenderATPOnboardingLinuxServer.py  MicrosoftDefenderATPOnboardingLinuxServerOld.py"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "[labmin@CENTSOS-02 ~]$ diff Master.txt Boss.txt\r\n1d0\r\n< Apple"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Compress a file"
            },
            {
              "Type": "Code",
              "Value": "gzip Master.txt"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "ls -l Ma*\r\n-rw-rw-r--. 1 labmin labmin 48 Sep 20 05:12 Master.txt.gz"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Uncompress files"
            },
            {
              "Type": "Code",
              "Value": "gunzip Master.txt.gz"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "ls -l Ma*\r\n-rw-rw-r--. 1 labmin labmin 17 Sep 20 05:12 Master.txt"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check disk space (human readable format)"
            },
            {
              "Type": "Code",
              "Value": "df -h"
            },
            {
              "Type": "Title",
              "Value": "Check disk space for a specific folder"
            },
            {
              "Type": "Code",
              "Value": "du -sh /home/labmin"
            },
            {
              "Type": "Title",
              "Value": "Check disk space (inode format)"
            },
            {
              "Type": "Code",
              "Value": "df -i"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Description",
              "Value": "`df -h` will print sizes in powers of 1024 (e.g., 1023M)"
            },
            {
              "Type": "Code",
              "Value": "Filesystem      Size  Used Avail Use% Mounted on\r\ndevtmpfs        930M     0  930M   0% /dev\r\ntmpfs           947M  4.0K  947M   1% /dev/shm\r\ntmpfs           947M  8.6M  939M   1% /run\r\ntmpfs           947M     0  947M   0% /sys/fs/cgroup\r\n/dev/sda2       8.0G  3.1G  5.0G  39% /\r\n/dev/sda1      1014M  262M  753M  26% /boot\r\n/dev/sdb1       3.9G   24K  3.7G   1% /mnt\r\ntmpfs           190M     0  190M   0% /run/user/1000"
            },
            {
              "Type": "Code",
              "Value": "252K    /home/labmin"
            },
            {
              "Type": "Description",
              "Value": "`df -i` list inode information instead of block usage"
            },
            {
              "Type": "Code",
              "Value": "Filesystem      Inodes IUsed   IFree IUse% Mounted on\r\ndevtmpfs        240507   353  240154    1% /dev\r\ntmpfs           244837     1  244836    1% /dev/shm\r\ntmpfs           244837   552  244285    1% /run\r\ntmpfs           244837    17  244820    1% /sys/fs/cgroup\r\n/dev/sda2      4193792 62085 4131707    2% /\r\n/dev/sda1       524288   317  523971    1% /boot\r\n/dev/sdb1       262144    11  262133    1% /mnt\r\ntmpfs           244837     5  244832    1% /run/user/1001"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Shell"
            },
            {
              "Type": "Description",
              "Value": "What shell are you using?"
            },
            {
              "Type": "Code",
              "Value": "echo $SHELL"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "/bin/bash"
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Install the MDE agent",
      "description": "",
      "tasks": [
        {
          "title": "Get Distro version",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Get Distro version"
            },
            {
              "Type": "Description",
              "Value": "Get Distro version"
            },
            {
              "Type": "Code",
              "Value": "cat /etc/os-release"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "NAME=\"CentOS Stream\"\r\nVERSION=\"8\"\r\nID=\"centos\"\r\nID_LIKE=\"rhel fedora\"\r\nVERSION_ID=\"8\"\r\nPLATFORM_ID=\"platform:el8\"\r\nPRETTY_NAME=\"CentOS Stream 8\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:centos:centos:8\"\r\nHOME_URL=\"https://centos.org/\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\nREDHAT_SUPPORT_PRODUCT=\"Red Hat Enterprise Linux 8\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"CentOS Stream\"\r\n[labmin@CENTSOS-02 ~]$"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check if MDATP is installed"
            },
            {
              "Type": "Code",
              "Value": "which mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "/usr/bin/mdatp"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check daemon status"
            },
            {
              "Type": "Code",
              "Value": "systemctl status mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "\u25CF mdatp.service - Microsoft Defender\r\n   Loaded: loaded (/usr/lib/systemd/system/mdatp.service; enabled; vendor preset: disabled)\r\n   Active: active (running) since Wed 2023-09-20 03:18:14 UTC; 3h 19min ago\r\n Main PID: 714 (wdavdaemon)\r\n    Tasks: 260 (limit: 11894)\r\n   Memory: 1.0G\r\n   CGroup: /system.slice/mdatp.service\r\n           \u251C\u2500 714 /opt/microsoft/mdatp/sbin/wdavdaemon\r\n           \u251C\u2500 927 /opt/microsoft/mdatp/sbin/wdavdaemon edr 12 11 --log_level info\r\n           \u251C\u25001097 /opt/microsoft/mdatp/sbin/telemetryd_v2 32\"\r\n           \u251C\u25001298 /opt/microsoft/mdatp/sbin/wdavdaemon_network_protection network_protection 46 45\r\n           \u2514\u25001838 /opt/microsoft/mdatp/sbin/wdavdaemon unprivileged 61 264 266 268 57 --log_level info"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Fedora Install"
            },
            {
              "Type": "Code",
              "Value": "yum update\r\nyum install yum-utils\r\nyum-config-manager --add-repo=https://packages.microsoft.com/config/fedora/38/prod.repo\r\nrpm --import http://packages.microsoft.com/keys/microsoft.asc\r\nyum install mdatp\r\nyum install pcre"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Oracle Install"
            },
            {
              "Type": "Code",
              "Value": "yum update\r\nyum install yum-utils\r\nyum-config-manager --add-repo=https://packages.microsoft.com/config/rhel/8/prod.repo\r\nrpm --import http://packages.microsoft.com/keys/microsoft.asc\r\nyum install mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "RHEL via Puppet Install"
            },
            {
              "Type": "Code",
              "Value": "yum update\r\nyum install puppet-agent\r\nyum install yum-utils\r\nrpm -U http://yum.puppet.com/puppet6-release-el-9.noarch.rpm\r\nyum install puppet-agent\r\npuppet agent -t\r\n\r\n#On Puppet server\r\n/opt/puppetlabs/bin/puppetserver ca sign --all"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "SUSE Install"
            },
            {
              "Type": "Code",
              "Value": "zypper update\r\nrpm --import http://packages.microsoft.com/keys/microsoft.asc\r\nzypper install mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Ubuntu Install"
            },
            {
              "Type": "Code",
              "Value": "apt-get install update\r\napt-get install libplist-utils\r\napt-get install curl\r\ncurl -o microsoft.list https://packages.microsoft.com/config/ubuntu/20.04/prod.list\r\nmv ./microsoft.list /etc/apt/sources.list.d/microsoft-prod.list\r\napt-get install gpg\r\ncurl -sSL https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/microsoft.gpg > /dev/null\r\napt-get install apt-transport-https\r\napt-get update\r\napt-get install mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "SSH",
      "description": "",
      "tasks": [
        {
          "title": "Get RSA from PEM",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Get RSA from PEM"
            },
            {
              "Type": "Description",
              "Value": "Get RSA from PEM"
            },
            {
              "Type": "Code",
              "Value": "openssl rsa -in linkp.pem -out key.key"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "writing RSA key\r\nkey.key"
            }
          ]
        },
        {
          "title": "Copy file from Windows to Linux with SCP",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Copy file from Windows to Linux with SCP"
            },
            {
              "Type": "Description",
              "Value": "Copy file from Windows to Linux with SCP"
            },
            {
              "Type": "Code",
              "Value": "scp -i C:\\Users\\masontorres\\.ssh\\id_rsa\\linkp.key 'C:\\Users\\masontorres\\Downloads\\WindowsDefenderATPOnboardingPackage.zip' labmin@10.5.1.4:~"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Note",
              "Value": "No output sample"
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "title": "Repositories",
      "description": "",
      "tasks": [
        {
          "title": "Debian - Ubunutu",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Debian - Ubunutu"
            },
            {
              "Type": "Code",
              "Value": "apt-cache policy | grep microsoft"
            },
            {
              "Type": "Description",
              "Value": "OR"
            },
            {
              "Type": "Code",
              "Value": "sudo grep -Erh ^deb /etc/apt/sources.list* | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "500 https://packages.microsoft.com/ubuntu/20.04/prod focal/main all Packages\r\n     release o=microsoft-ubuntu-focal-prod focal,a=focal,n=focal,l=microsoft-ubuntu-focal-prod focal,c=main,b=all\r\n     origin packages.microsoft.com\r\n 500 https://packages.microsoft.com/ubuntu/20.04/prod focal/main arm64 Packages\r\n     release o=microsoft-ubuntu-focal-prod focal,a=focal,n=focal,l=microsoft-ubuntu-focal-prod focal,c=main,b=arm64\r\n     origin packages.microsoft.com\r\n 500 https://packages.microsoft.com/ubuntu/20.04/prod focal/main armhf Packages\r\n     release o=microsoft-ubuntu-focal-prod focal,a=focal,n=focal,l=microsoft-ubuntu-focal-prod focal,c=main,b=armhf\r\n     origin packages.microsoft.com\r\n 500 https://packages.microsoft.com/ubuntu/20.04/prod focal/main amd64 Packages\r\n     release o=microsoft-ubuntu-focal-prod focal,a=focal,n=focal,l=microsoft-ubuntu-focal-prod focal,c=main,b=amd64\r\n     origin packages.microsoft.com"
            },
            {
              "Type": "Code",
              "Value": "deb [arch=amd64,armhf,arm64] https://packages.microsoft.com/ubuntu/20.04/prod focal main"
            }
          ]
        },
        {
          "title": "RPM - RedHat, Fedora, Oracle",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "RPM - RedHat, Fedora, Oracle"
            },
            {
              "Type": "Code",
              "Value": "sudo dnf repolist | grep microsoft"
            },
            {
              "Type": "Description",
              "Value": "OR"
            },
            {
              "Type": "Code",
              "Value": "yum repolist | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "microsoftpackages                                 packages-microsoft-com-prod-insiders-fast\r\nrhui-microsoft-azure-rhel9-eus                    Microsoft Azure RPMs for Red Hat Enterprise Linux 9 (rhel9-eus)"
            },
            {
              "Type": "Code",
              "Value": "microsoftpackages                                 packages-microsoft-com-prod-insiders-fast\r\nrhui-microsoft-azure-rhel9-eus                    Microsoft Azure RPMs for Red Hat Enterprise Linux 9 (rhel9-eus)"
            }
          ]
        },
        {
          "title": "SUSE, openSUSE",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "SUSE, openSUSE"
            },
            {
              "Type": "Code",
              "Value": "zypper lr | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "46 | packages-microsoft-com-prod                                                                | microsoft-prod                                          | Yes     | (r ) Yes  | Yes"
            }
          ]
        },
        {
          "title": "Arch Linux, EndeavourOS and Manjaro Linux",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Arch Linux, EndeavourOS and Manjaro Linux"
            },
            {
              "Type": "Code",
              "Value": "zypper lr | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Note",
              "Value": "Coming soon"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "CheatSheetMDELinux", "path": "./json/CheatSheetMDELinux.json", "data": {
  "title": "Cheat Sheet MDE Linux",
  "path": "/linux/cheat-sheet-mde",
  "section": "MDE",
  "subSection": "Linux",
  "description": "Use this cheat sheet to brush up on your Linux commands and for all those Linux commands you can't quite remember!",
  "data": [
    {
      "section": 1,
      "title": "MDATP",
      "description": "",
      "tasks": [
        {
          "title": "Check license",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check license"
            },
            {
              "Type": "Description",
              "Value": "Check license"
            },
            {
              "Type": "Code",
              "Value": "mdatp health --field org_id"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample - No license"
            },
            {
              "Type": "Code",
              "Value": "No license found"
            },
            {
              "Type": "Title",
              "Value": "Output sample - License"
            },
            {
              "Type": "Code",
              "Value": "org_id: 00000000-0000-0000-0000-000000000000"
            }
          ]
        },
        {
          "title": "Check health",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check health"
            },
            {
              "Type": "Description",
              "Value": "Check health"
            },
            {
              "Type": "Code",
              "Value": "mdatp health --field healthy"
            },
            {
              "Type": "Code",
              "Value": "mdatp health --field health_issues"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample - Healthy"
            },
            {
              "Type": "Code",
              "Value": "true"
            },
            {
              "Type": "Title",
              "Value": "Output sample - Health Issues"
            },
            {
              "Type": "Code",
              "Value": "[\"Network Protection cannot start due to unsupported release ring\"]"
            }
          ]
        },
        {
          "title": "Check Service",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Service"
            },
            {
              "Type": "Description",
              "Value": "Check Service status"
            },
            {
              "Type": "Code",
              "Value": "service auditd status"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample - Running"
            },
            {
              "Type": "Code",
              "Value": "\u25CF auditd.service - Security Auditing Service\r\n     Loaded: loaded (/lib/systemd/system/auditd.service; enabled; vendor preset: enabled)\r\n     Active: active (running) since Wed 2023-09-20 05:32:29 UTC; 12h ago\r\n       Docs: man:auditd(8)\r\n             https://github.com/linux-audit/audit-documentation\r\n   Main PID: 494 (auditd)\r\n      Tasks: 24 (limit: 9456)\r\n     Memory: 47.3M\r\n     CGroup: /system.slice/auditd.service\r\n             \u251C\u2500 494 /sbin/auditd\r\n             \u251C\u25001310 /sbin/audispd\r\n             \u2514\u25001311 /opt/microsoft/mdatp/sbin/mdatp_audisp_plugin"
            }
          ]
        },
        {
          "title": "Real Time Protection",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Enable Real Time Protection"
            },
            {
              "Type": "Code",
              "Value": "mdatp config real-time-protection --value enabled"
            },
            {
              "Type": "Title",
              "Value": "Disable Real Time Protection"
            },
            {
              "Type": "Code",
              "Value": "mdatp config real-time-protection --value disabled"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample - Enable"
            },
            {
              "Type": "Code",
              "Value": "Configuration property updated."
            },
            {
              "Type": "Title",
              "Value": "Output sample - Disable"
            },
            {
              "Type": "Code",
              "Value": "Configuration property updated."
            }
          ]
        },
        {
          "title": "Potentially Unwanted Applications PAU ",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Potentially Unwanted Applications - off"
            },
            {
              "Type": "Code",
              "Value": "mdatp threat policy set --type potentially_unwanted_application --action off"
            },
            {
              "Type": "Title",
              "Value": "Disable Potentially Unwanted Applications - audit"
            },
            {
              "Type": "Code",
              "Value": "mdatp threat policy set --type potentially_unwanted_application --action audit"
            },
            {
              "Type": "Title",
              "Value": "Disable Potentially Unwanted Applications - block"
            },
            {
              "Type": "Code",
              "Value": "mdatp threat policy set --type potentially_unwanted_application --action block"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "Threat policy modified successfully"
            }
          ]
        },
        {
          "title": "eBPF sensor (Extended Berkley Packet Filter)",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Enable eBPF sensor (Extended Berkley Packet Filter)"
            },
            {
              "Type": "Code",
              "Value": "mdatp config ebpf-supplementary-event-provider --value enabled"
            },
            {
              "Type": "Title",
              "Value": "Disable eBPF sensor (Extended Berkley Packet Filter)"
            },
            {
              "Type": "Code",
              "Value": "mdatp config ebpf-supplementary-event-provider --value disabled"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "Configuration property updated."
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Logs",
      "description": "",
      "tasks": [
        {
          "title": "Log location",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "MDE - Log location"
            },
            {
              "Type": "Code",
              "Value": "/var/log/microsoft/mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "MDE - Log location"
            },
            {
              "Type": "Code",
              "Value": "ls -l /var/log/microsoft/mdatp\r\ntotal 8056\r\n-rw-r----- 1 mdatp mdatp   15006 Sep 20 05:21 install.log\r\n-rw-r----- 1 mdatp mdatp   90361 Sep 20 18:02 microsoft_defender.log\r\n-rw-r----- 1 mdatp mdatp 2828306 Sep 20 18:02 microsoft_defender_core.log\r\n-rw-r----- 1 mdatp mdatp 3148549 Sep 20 18:01 microsoft_defender_core_err.log\r\n-rw-r----- 1 mdatp mdatp  584080 Sep 20 05:32 microsoft_defender_diagnostic.log\r\n-rw-r----- 1 mdatp mdatp     794 Sep 20 05:21 microsoft_defender_diagnostic_err.log\r\n-rw-r----- 1 mdatp mdatp    1312 Aug 21 23:00 microsoft_defender_diagnostic_event_provider_counters.json\r\n-rw-r----- 1 mdatp mdatp  552418 Sep 20 18:02 microsoft_defender_enterprise.log\r\n-rw-r----- 1 mdatp mdatp  388710 Sep 20 18:02 microsoft_defender_enterprise_err.log\r\n-rw-r----- 1 mdatp mdatp   32121 Sep 20 05:32 microsoft_defender_enterprise_imds.log\r\n-rw-r----- 1 mdatp mdatp  271125 Sep 20 18:02 microsoft_defender_enterprise_telemetryd.log\r\n-rw-r----- 1 mdatp mdatp    7345 Sep 20 16:22 microsoft_defender_enterprise_telemetryd_err.log\r\n-rw-r----- 1 mdatp mdatp   11737 Sep 20 13:32 microsoft_defender_err.log\r\n-rw-r----- 1 mdatp mdatp  251404 Sep 20 18:02 microsoft_defender_mplog.log\r\ndrwxrwxr-x 2 root  mdatp    4096 Sep 20 05:15 rotated\r\n-rw-r----- 1 mdatp mdatp    3137 Sep 20 05:21 uninstall.log"
            }
          ]
        },
        {
          "title": "Check Permissions",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Permissions"
            },
            {
              "Type": "Description",
              "Value": "Using the stat command we can check the permissions of the directories and files."
            },
            {
              "Type": "Code",
              "Value": "stat /var"
            },
            {
              "Type": "Code",
              "Value": "stat /var/log"
            },
            {
              "Type": "Code",
              "Value": "stat /var/log/microsoft"
            },
            {
              "Type": "Description",
              "Value": "The 'Access' should show permissions matching: (0755/drwxr-xr-x) If they do not match, update them with the below commands"
            },
            {
              "Type": "Code",
              "Value": "chmod 755 /var\r\nchmod 755 /var/log\r\nchmod 755 /var/log/microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Check Permissions - /var"
            },
            {
              "Type": "Code",
              "Value": "File: /var\r\n  Size: 4096            Blocks: 8          IO Block: 4096   directory\r\nDevice: 801h/2049d      Inode: 68806       Links: 13\r\nAccess: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)\r\nAccess: 2023-08-25 18:35:28.292450372 +0000\r\nModify: 2023-07-24 21:41:47.157883351 +0000\r\nChange: 2023-07-24 21:42:30.429271666 +0000\r\n Birth: -"
            },
            {
              "Type": "Title",
              "Value": "Check Permissions - /var/log"
            },
            {
              "Type": "Code",
              "Value": "File: /var/log\r\n  Size: 4096            Blocks: 8          IO Block: 4096   directory\r\nDevice: 801h/2049d      Inode: 81012       Links: 12\r\nAccess: (0775/drwxrwxr-x)  Uid: (    0/    root)   Gid: (  110/  syslog)\r\nAccess: 2023-09-20 05:37:41.752210675 +0000\r\nModify: 2023-09-20 05:32:38.521892324 +0000\r\nChange: 2023-09-20 05:32:38.521892324 +0000\r\n Birth: -"
            },
            {
              "Type": "Title",
              "Value": "Check Permissions - /var/log/microsoft"
            },
            {
              "Type": "Code",
              "Value": "File: /var/log/microsoft\r\n  Size: 4096            Blocks: 8          IO Block: 4096   directory\r\nDevice: 801h/2049d      Inode: 258442      Links: 3\r\nAccess: (0755/drwxr-xr-x)  Uid: (    0/    root)   Gid: (    0/    root)\r\nAccess: 2023-08-25 18:35:30.680535168 +0000\r\nModify: 2023-08-18 23:40:09.156314644 +0000\r\nChange: 2023-09-20 05:21:23.200663892 +0000\r\n Birth: -"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Find Software",
      "description": "",
      "tasks": [
        {
          "title": "Find other antivirus software",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Find other antivirus software"
            },
            {
              "Type": "Description",
              "Value": "One method for identifying other antivirus software is to look for the process.  The below command will show all processes with 'av' in the name.  If you see other antivirus software, you will need to remove it before installing MDE."
            },
            {
              "Type": "Code",
              "Value": "ps aux | grep av"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Output sample"
            },
            {
              "Type": "Code",
              "Value": "root         715  0.1  1.7 1128896 143840 ?      Ssl  18:08   0:03 /opt/microsoft/mdatp/sbin/wdavdaemon\r\nroot         967  0.1  0.8 811776 65576 ?        Sl   18:08   0:02 /opt/microsoft/mdatp/sbin/wdavdaemon edr 11 10 --log_level info\r\nmdatp       1466  0.2  2.2 912728 182912 ?       Sl   18:09   0:04 /opt/microsoft/mdatp/sbin/wdavdaemon unprivileged 300 308 310 312 52 --log_level info\r\nlabmin      2152  0.0  0.0   8168   720 pts/0    S+   18:39   0:00 grep --color=auto av"
            }
          ]
        },
        {
          "title": "List installed software - Ubutnu/Debian",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "List installed software - Ubutnu/Debian"
            },
            {
              "Type": "Code",
              "Value": "dpkg --get-selections"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Code",
              "Value": "accountsservice                                 install\r\nadduser                                         install\r\nalsa-topology-conf                              install\r\nalsa-ucm-conf                                   install\r\napparmor                                        install\r\napport                                          install\r\napport-symptoms                                 install\r\napt                                             install\r\napt-transport-https                             install\r\napt-utils                                       install\r\nat                                              install\r\nauditd                                          install"
            }
          ]
        },
        {
          "title": "List installed software - Red Hat/CentOS",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "List installed software - Red Hat/CentOS"
            },
            {
              "Type": "Code",
              "Value": "dnf list installed"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Code",
              "Value": "Installed Packages\r\nNetworkManager.x86_64                                                           1:1.32.10-4.el8                                                                 @anaconda\r\nNetworkManager-libnm.x86_64                                                     1:1.32.10-4.el8                                                                 @anaconda\r\nNetworkManager-team.x86_64                                                      1:1.32.10-4.el8                                                                 @anaconda\r\nNetworkManager-tui.x86_64                                                       1:1.32.10-4.el8                                                                 @anaconda\r\nPackageKit.x86_64                                                               1.1.12-6.el8                                                                    @AppStream\r\nPackageKit-glib.x86_64                                                          1.1.12-6.el8                                                                    @AppStream\r\nWALinuxAgent.noarch                                                             2.7.3.0-1_ol002.el8                                                             @openlogic\r\nWALinuxAgent-udev.noarch                                                        2.7.3.0-1_ol002.el8                                                             @openlogic\r\nabattis-cantarell-fonts.noarch                                                  0.0.25-6.el8                                                                    @AppStream\r\nacl.x86_64                                                                      2.2.53-1.el8                                                                    @anaconda\r\nadcli.x86_64                                                                    0.8.2-12.el8                                                                    @anaconda\r\nat.x86_64                                                                       3.1.20-11.el8                                                                   @anaconda\r\nattr.x86_64                                                                     2.4.48-3.el8                                                                    @anaconda\r\naudit.x86_64                                                                    3.0-0.17.20191104git1c2f876.el8                                                 @anaconda\r\naudit-libs.x86_64                                                               3.0-0.17.20191104git1c2f876.el8                                                 @anaconda"
            }
          ]
        },
        {
          "title": "Use the Security portal",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check device installed software"
            },
            {
              "Type": "Description",
              "Value": "Use the Security portal to check the installed software on your devices. https://security.microsoft.com/ "
            },
            {
              "Type": "Description",
              "Value": "Navigate to Devices > Device Inventory > Select the device > Software Inventory"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/linux/DeviceInventoryLinux.png"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "GeneralPerformance", "path": "./json/GeneralPerformance.json", "data": {
  "title": "Performance Monitoring",
  "path": "/linux/performance-monitoring",
  "section": "Linux",
  "subSection": "",
  "description": "General performance monitoring for Linux.",
  "data": [
    {
      "section": 1,
      "title": "System Load Monitoring",
      "description": "Monitor the system load to understand the demand on system resources.",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check System Load"
            },
            {
              "Type": "Description",
              "Value": "uptime  gives a one line display of the following information.  The current time, how long the system has been running, how many users are currently logged on, and the system load  averages for the past 1, 5, and 15 minutes."
            },
            {
              "Type": "Code",
              "Value": "uptime"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the current system load averages for the past 1, 5, and 15 minutes."
            },
            {
              "Type": "Code",
              "Value": "15:48:32 up 1 min,  1 user,  load average: 0.80, 0.45, 0.17"
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Memory Usage Monitoring",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Memory Usage"
            },
            {
              "Type": "Description",
              "Value": " free  displays  the  total  amount of free and used physical and swap memory in the system, as well as the buffers and caches used by the kernel."
            },
            {
              "Type": "Code",
              "Value": "free -m"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the total, used, and free memory in megabytes."
            },
            {
              "Type": "Code",
              "Value": "              total        used        free      shared  buff/cache   available\r\nMem:           1912         461         973           8         477        1230\r\nSwap:             0           0           0"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Memory Usage Additional Commands"
            },
            {
              "Type": "Description",
              "Value": "`free` gets its information from the /proc/meminfo file. You can view /proc/meminfor more detailed information."
            },
            { "Type": "Code", "Value": "cat /proc/meminfo" }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Code",
              "Value": "MemTotal:        1958696 kB\r\nMemFree:          382652 kB\r\nMemAvailable:    1217840 kB\r\nBuffers:            3152 kB\r\nCached:          1007968 kB\r\nSwapCached:            0 kB\r\nActive:           582472 kB\r\nInactive:         785500 kB\r\nActive(anon):       1284 kB\r\nInactive(anon):   364300 kB\r\nActive(file):     581188 kB\r\nInactive(file):   421200 kB\r\nUnevictable:           0 kB\r\nMlocked:               0 kB\r\nSwapTotal:             0 kB\r\nSwapFree:              0 kB\r\nDirty:                 4 kB\r\nWriteback:             0 kB\r\nAnonPages:        356756 kB\r\nMapped:           171464 kB\r\nShmem:              8736 kB\r\nKReclaimable:      59732 kB\r\nSlab:             104568 kB\r\nSReclaimable:      59732 kB\r\nSUnreclaim:        44836 kB\r\nKernelStack:        5088 kB\r\nPageTables:        12632 kB\r\nNFS_Unstable:          0 kB\r\nBounce:                0 kB\r\nWritebackTmp:          0 kB\r\nCommitLimit:      979348 kB\r\nCommitted_AS:    2867208 kB\r\nVmallocTotal:   34359738367 kB\r\nVmallocUsed:           0 kB\r\nVmallocChunk:          0 kB\r\nPercpu:              584 kB\r\nHardwareCorrupted:     0 kB\r\nAnonHugePages:     14336 kB\r\nShmemHugePages:        0 kB\r\nShmemPmdMapped:        0 kB\r\nFileHugePages:         0 kB\r\nFilePmdMapped:         0 kB\r\nHugePages_Total:       0\r\nHugePages_Free:        0\r\nHugePages_Rsvd:        0\r\nHugePages_Surp:        0\r\nHugepagesize:       2048 kB\r\nHugetlb:               0 kB\r\nDirectMap4k:      110528 kB\r\nDirectMap2M:     1986560 kB\r\nDirectMap1G:     2097152 kB"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Disk Usage Monitoring",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Disk Usage"
            },
            {
              "Type": "Description",
              "Value": " df displays the amount of disk space available on the file system containing each file name argument.  If no file  name  is  given,  the space  available  on  all  currently mounted file systems is shown."
            },
            {
              "Type": "Note",
              "Value": "`-h` option is used to display the output in human readable format."
            },
            {
              "Type": "Code",
              "Value": "df -h"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the disk usage of all mounted filesystems."
            },
            {
              "Type": "Code",
              "Value": "Filesystem      Size  Used Avail Use% Mounted on\r\ndevtmpfs        940M     0  940M   0% /dev\r\ntmpfs           957M     0  957M   0% /dev/shm\r\ntmpfs           957M  8.6M  948M   1% /run\r\ntmpfs           957M     0  957M   0% /sys/fs/cgroup\r\n/dev/sda2       8.0G  2.7G  5.4G  33% /\r\n/dev/sda1      1014M  223M  792M  22% /boot\r\n/dev/sdb1       3.9G   16M  3.7G   1% /mnt\r\ntmpfs           192M     0  192M   0% /run/user/1001"
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "title": "CPU Usage Monitoring",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check CPU Usage"
            },
            {
              "Type": "Description",
              "Value": "The  top program provides a dynamic real-time view of a running system. It can display system summary information as well as a list of processes or threads currently being managed by the Linux  kernel."
            },
            {
              "Type": "Code",
              "Value": "top"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the current CPU usage for each process."
            },
            {
              "Type": "Code",
              "Value": "top - 15:50:18 up 3 min,  1 user,  load average: 0.14, 0.31, 0.15\r\nTasks: 125 total,   2 running, 123 sleeping,   0 stopped,   0 zombie\r\n%Cpu(s):  0.7 us,  0.3 sy,  0.0 ni, 98.7 id,  0.0 wa,  0.3 hi,  0.0 si,  0.0 st\r\nMiB Mem :   1912.8 total,    972.7 free,    461.8 used,    478.2 buff/cache\r\nMiB Swap:      0.0 total,      0.0 free,      0.0 used.   1229.3 avail Mem\r\n\r\n    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND\r\n    797 root      20   0 1151996 141996  57996 S   0.7   7.2   0:03.63 wdavdaemon\r\n    398 root      20   0       0      0      0 R   0.3   0.0   0:00.05 kworker/0:4-events_power_effici+\r\n    997 root      20   0  891196  67168  48116 S   0.3   3.4   0:01.04 wdavdaemon\r\n   1101 root      20   0  307864  17044  13600 S   0.3   0.9   0:00.23 telemetryd_v2\r\n   1296 root      20   0  448072  29588  11688 S   0.3   1.5   0:00.98 python3\r\n      1 root      20   0  175160  13556   8904 S   0.0   0.7   0:02.22 systemd\r\n      2 root      20   0       0      0      0 S   0.0   0.0   0:00.00 kthreadd\r\n      3 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_gp\r\n      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_par_gp\r\n      5 root      20   0       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0-events\r\n      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0H-e"
            }
          ]
        }
      ]
    },
    {
      "section": 5,
      "title": "Network Usage Monitoring",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check Network Usage"
            },
            {
              "Type": "Description",
              "Value": "nload is a console application which monitors network traffic and bandwidth usage in real time. It visualizes the in and outgoing traffic using two graphs and provides additional info like the total amount of transfered data and min/max network usage."
            },
            {
              "Type": "Code",
              "Value": "nload"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the current network usage for each interface."
            },
            {
              "Type": "Code",
              "Value": "Device eth0 [10.5.1.6] (1/2):\r\n==\r\nIncoming:\r\n\r\n\r\n                                           Curr: 856.00 Bit/s\r\n                                           Avg: 9.01 kBit/s\r\n                                           Min: 856.00 Bit/s\r\n                                           Max: 77.59 kBit/s\r\n                                           Ttl: 31.74 MByte\r\nOutgoing:\r\n\r\n\r\n                                           Curr: 6.38 kBit/s\r\n                                           Avg: 16.96 kBit/s\r\n                                           Min: 3.79 kBit/s\r\n                                           Max: 91.63 kBit/s\r\n                                           Ttl: 11.34 MByte"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "MDELinuxCentosSetup", "path": "./json/MDELinuxCentosSetup.json", "data": {
  "title": "Setup - Centos",
  "path": "/mde/linux-setup-centos",
  "section": "MDE",
  "subSection": "Linux",
  "description": "",
  "data": [
    {
      "section": 1,
      "title": "Checking Existing Install",
      "description": "What do we have already?",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Get Distro Version"
            },
            {
              "Type": "Description",
              "Value": "This exercie assumes you have a Linux VM setup and running Centos."
            },
            {
              "Type": "Code",
              "Value": "cat /etc/os-release"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Example output"
            },
            {
              "Type": "Code",
              "Value": "NAME=\"CentOS Linux\"\n  VERSION=\"8\"\n  ID=\"centos\"\n  ID_LIKE=\"rhel fedora\"\n  VERSION_ID=\"8\"\n  PLATFORM_ID=\"platform:el8\"\n  PRETTY_NAME=\"CentOS Linux 8\"\n  ANSI_COLOR=\"0;31\"\n  CPE_NAME=\"cpe:/o:centos:centos:8\"\n  HOME_URL=\"https://centos.org/\"\n  BUG_REPORT_URL=\"https://bugs.centos.org/\"\n  CENTOS_MANTISBT_PROJECT=\"CentOS-8\"\n  CENTOS_MANTISBT_PROJECT_VERSION=\"8\""
            }
          ]
        },
        {
          "title": "Has MDATP already been installed?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check if MDATP is installed"
            },
            {
              "Type": "Code",
              "Value": "which mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Description",
              "Value": "The command will return the location of the binary/executable if it is found."
            },
            {
              "Type": "Code",
              "Value": "/bin/mdatp"
            }
          ]
        },
        {
          "title": "What's the status of the daemon?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check daemon status"
            },
            {
              "Type": "Code",
              "Value": "service mdatp status"
            },
            {
              "Type": "Description",
              "Value": "The above command will only work if the daemon is installed and running."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": " mdatp.service - Microsoft Defender\n              Loaded: loaded (/usr/lib/systemd/system/mdatp.service; enabled; vendor preset: disabled)\n              Active: active (running) since Wed 2023-09-13 19:57:32 UTC; 1h 16min ago\n            Main PID: 4802 (wdavdaemon)\n               Tasks: 159 (limit: 12024)\n              Memory: 322.6M\n              CGroup: /system.slice/mdatp.service\n                      4802 /opt/microsoft/mdatp/sbin/wdavdaemon\n                      4836 /opt/microsoft/mdatp/sbin/wdavdaemon edr 12 11 --log_level info\n                      4923 /opt/microsoft/mdatp/sbin/telemetryd_v2 33\"\n                      5504 /opt/microsoft/mdatp/sbin/wdavdaemon unprivileged 265 270 287 289 259 --log_level info"
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Envrionment Setup",
      "description": "Getting the environment ready for MDE for Linux on Centos",
      "tasks": [
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Update system packages"
            },
            {
              "Type": "Description",
              "Value": "Update packages using the yum package manager"
            },
            {
              "Type": "Code",
              "Value": "yum update"
            },
            {
              "Type": "Note",
              "Value": "Each Linux distrobution has a different package manager. For example, Ubuntu uses apt-get, while Centos uses yum."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/CentosYumUpdate.png"
            }
          ]
        },
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Add the Microsoft repo to isntall MDE"
            },
            {
              "Type": "Code",
              "Value": "rpm -Uvh https://packages.microsoft.com/config/rhel/8/prod.repo"
            },
            {
              "Type": "Description",
              "Value": "You can view the different repos available at https://packages.microsoft.com/config/rhel/"
            },
            {
              "Type": "Description",
              "Value": "Select your distro and version to see the repo information."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample yum update output"
            },
            {
              "Type": "Description",
              "Value": "The RPM package repository will be added to the system. This will allow you to install MDE using yum."
            },
            {
              "Type": "Description",
              "Value": "The output below shows the RPM package being added to the system."
            },
            {
              "Type": "Code",
              "Value": "sudo dnf repolist | grep microsoft"
            },
            {
              "Type": "Code",
              "Value": "yum repolist | grep microsoft"
            },
            {
              "Type": "Title",
              "Value": "Sample repo packages"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/RhelRepos.png"
            }
          ]
        },
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check the respoiory list to see if the Microsoft repo has been added"
            },
            {
              "Type": "Code",
              "Value": "sudo dnf repolist | grep microsoft"
            },
            {
              "Type": "Description",
              "Value": "OR"
            },
            {
              "Type": "Code",
              "Value": "yum repolist | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample dnf output"
            },
            {
              "Type": "Code",
              "Value": "microsoftpackages         packages-microsoft-com-prod-insiders-fast"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Install MDE for Linux",
      "description": "Steps to install the MDE for Linux agent on Centos",
      "tasks": [
        {
          "title": "Install the MDE package.",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Install MDE"
            },
            {
              "Type": "Code",
              "Value": "sudo yum install mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "We can view the logs for this installation in /var/log/microsoft/mdatp/install.log"
            },
            {
              "Type": "Code",
              "Value": "cat /var/log/microsoft/mdatp/install.log"
            },
            {
              "Type": "Note",
              "Value": "The 'cat' command will print the file to the screen. You can also use 'less' to view the file."
            },
            {
              "Type": "Code",
              "Value": "preinstall\n  Arguments passed to the preinstall script: 1\n  preinstall begin [2023-08-28 16:25:28OURCE +0000] 59060\n  correlation id=574704c0-1a70-4b4c-9ca7-7c4df70e3bf8\n  Generation installation id\n  is_new_install=1, bundle_version=101.23072.0021, branch=release/linux/2307-2\n  File /opt/microsoft/mdatp/conf/BuildInfo not found\n  NAME=\"CentOS Linux\"\n  VERSION=\"8\"\n  ID=\"centos\"\n  ID_LIKE=\"rhel fedora\"\n  VERSION_ID=\"8\"\n  PLATFORM_ID=\"platform:el8\"\n  PRETTY_NAME=\"CentOS Linux 8\"\n  ANSI_COLOR=\"0;31\"\n  CPE_NAME=\"cpe:/o:centos:centos:8\"\n  HOME_URL=\"https://centos.org/\"\n  BUG_REPORT_URL=\"https://bugs.centos.org/\"\n  CENTOS_MANTISBT_PROJECT=\"CentOS-8\"\n  CENTOS_MANTISBT_PROJECT_VERSION=\"8\"\n  DISTRO: centos\n  DISTRO_VERSION: 8.5\n  DISTRO_FAMILY: redhat\n  Installed kernel version: 4.18.0-348.7.1.el8_5.x86_64\n  Not a Redhat-7 distribution\n  Scenario= Install\n  Machine Guid: 488afa59-53f8-3b4c-a537-c9a97144172d\n  Creating daemon user\n  Daemon user (mdatp) created successfully\n  Logging pending telemetry\n  [LogTelemetry] Submitting {\n          \"client\": {\n              \"appVersion\": \"101.23072.0021\",\n              \"hostname\": \"centos-01\",\n              \"platform\": \"Linux\",\n              \"machineGuid\": \"488afa59-53f8-3b4c-a537-c9a97144172d\",\n              \"orgId\": \"\",\n              \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\n          },\n          \"reports\":[\n              {\n                  \"$type\":\"installationReport\",\n                  \"correlation_id\": \"574704c0-1a70-4b4c-9ca7-7c4df70e3bf8\",\n                  \"version\": \"101.23072.0021\",\n                  \"severity\": \"W\",\n                  \"code\":\"FileNotExist\",\n                  \"text\":\"File /opt/microsoft/mdatp/conf/BuildInfo not found\"\n              }\n          ]\n      }\n  Telemetry Submitted\n  [LogTelemetry] result=0\n  [LogTelemetry] Submitting {\n          \"client\": {\n              \"appVersion\": \"101.23072.0021\",\n              \"hostname\": \"centos-01\",\n              \"platform\": \"Linux\",\n              \"machineGuid\": \"488afa59-53f8-3b4c-a537-c9a97144172d\",\n              \"orgId\": \"\",\n              \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\n          },\n          \"reports\":[\n              {\n                  \"$type\":\"installationReport\",\n                  \"correlation_id\": \"574704c0-1a70-4b4c-9ca7-7c4df70e3bf8\",\n                  \"version\": \"101.23072.0021\",\n                  \"severity\": \"I\",\n                  \"code\":\"InstallStarted\",\n                  \"text\":\"is_new_install='1', bundle_version='101.23072.0021', branch='release/linux/2307-2', package=''\"\n              }\n          ]\n      }\n  Telemetry Submitted\n  [LogTelemetry] result=0\n  preinstall end [2023-08-28 16:25:29OURCE +0000] 59060\n  postinstall\n  "
            },
            {
              "Type": "Description",
              "Value": "We can also use `grep` to search for specific text in the file."
            },
            {
              "Type": "Code",
              "Value": "cat /var/log/microsoft/mdatp/install.log | grep VERSION_ID"
            },
            {
              "Type": "Code",
              "Value": "VERSION_ID=\"8\""
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "title": "Explore the MDATP application",
      "description": "Let's check the configuration of the MDE for Linux agent",
      "tasks": [
        {
          "title": "Health check",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Health check"
            },
            {
              "Type": "Code",
              "Value": "mdatp health"
            },
            {
              "Type": "Note",
              "Value": "The 'mdatp health' command will show the health of the MDE for Linux agent. This will show if the agent is healthy, if there are any health issues, if the agent is licensed, and configurations values."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "healthy                                     : true\n  health_issues                               : []\n  licensed                                    : true\n  engine_version                              : \"1.1.23080.2007\"\n  app_version                                 : \"101.23082.0006\"\n  org_id                                      : \"e1fb4f0a-1fbe-4181-b3e3-180f6e6ac31f\"\n  log_level                                   : \"info\"\n  machine_guid                                : \"488afa59-53f8-3b4c-a537-c9a97144172d\"\n  release_ring                                : \"InsiderFast\"\n  product_expiration                          : May 29, 2024 at 04:26:26 AM\n  cloud_enabled                               : true\n  cloud_automatic_sample_submission_consent   : \"safe\"\n  cloud_diagnostic_enabled                    : false\n  passive_mode_enabled                        : false\n  behavior_monitoring                         : \"disabled\"\n  real_time_protection_enabled                : true\n  real_time_protection_available              : true\n  real_time_protection_subsystem              : \"fanotify\"\n  supplementary_events_subsystem              : \"ebpf\"\n  tamper_protection                           : \"disabled\"\n  automatic_definition_update_enabled         : true\n  definitions_updated                         : Sep 13, 2023 at 07:57:47 PM\n  definitions_updated_minutes_ago             : 114\n  definitions_version                         : \"1.397.911.0\"\n  definitions_status                          : \"up_to_date\"\n  edr_early_preview_enabled                   : \"disabled\"\n  edr_device_tags                             : []\n  edr_group_ids                               : \"\"\n  edr_configuration_version                   : \"30.199999.main.2023.09.12.17-C66E94972A44477D660E4B10FE61A2673B9201934B5797BEF69B78B21746A58B\"\n  edr_machine_id                              : \"138fb85fae1f265d23f2ba51597d3dad830ff411\"\n  conflicting_applications                    : []\n  network_protection_status                   : \"stopped\"\n  network_protection_enforcement_level        : \"disabled\"\n  troubleshooting_mode                        : false"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "MDELinuxDiagnostics", "path": "./json/MDELinuxDiagnostics.json", "data": {
  "title": "Diagnostics",
  "path": "/mde/linux-diagnostics",
  "section": "MDE",
  "subSection": "Linux",
  "description": "Troubleshoot MDE product issues and collect diagnostics",
  "data": [
    {
      "section": 1,
      "title": "Diagnostic",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Run mdatp diagnostic"
            },
            {
              "Type": "Description",
              "Value": "This command provides diagnostic tests for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Description",
              "Value": "There are several options to create diagnostic data and upload it to Microsoft."
            },
            {
              "Type": "Code",
              "Value": "  antivirus-engine-pool-content         Monitor the content for all antivirus engine core pools content\r\n  create                                Generate support log\r\n  real-time-protection-statistics       Display real-time protection resource usage statistics\r\n  event-provider-statistics             Display event provider internal statistics\r\n  behavior-monitoring-statistics        Display behavior monitoring resource usage statistics\r\n  hot-event-sources                     Monitor hot event sources (preview feature)\r\n  ebpf-statistics                       Display ebpf internal statistics\r\n  upload                                Generate and submit support log to Microsoft"
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Real Time Protection Statistics",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check real-time protection statistics"
            },
            {
              "Type": "Description",
              "Value": "This command checks the real-time protection statistics for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic real-time-protection-statistics"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "sssd (Process id: 734): Scanned 1 file in 20669141 ns. Status: Active.\r\nsssd_be (Process id: 766): Scanned 1 file in 17035217 ns. Status: Active.\r\nsssd_nss (Process id: 769): Scanned 1 file in 16136611 ns. Status: Active.\r\npython3 (Process id: 1265): Scanned 2 files in 52417247 ns. Status: Active.\r\nagetty (Process id: 1267): Scanned 1 file in 12299 ns. Status: Active.\r\nagetty (Process id: 1271): Scanned 1 file in 9999 ns. Status: Active.\r\npython3 (Process id: 1296): Scanned 639 files in 2852327839 ns. Status: Active.\r\nsshd (Process id: 1737): Scanned 3 files in 36861644 ns. Status: Active.\r\nanacron (Process id: 2080): Scanned 3 files in 15714307 ns. Status: Active."
            },
            {
              "Type": "Code",
              "Value": "=====================================\r\nProcess id: 734\r\nName: sssd\r\nPath: \"/usr/sbin/sssd\"\r\nTotal files scanned: 1\r\nScan time (ns): \"20669141\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 766\r\nName: sssd_be\r\nPath: \"/usr/libexec/sssd/sssd_be\"\r\nTotal files scanned: 1\r\nScan time (ns): \"17035217\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 769\r\nName: sssd_nss\r\nPath: \"/usr/libexec/sssd/sssd_nss\"\r\nTotal files scanned: 1\r\nScan time (ns): \"16136611\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 1265\r\nName: python3\r\nPath: \"/usr/libexec/platform-python3.6\"\r\nTotal files scanned: 2\r\nScan time (ns): \"52417247\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 1267\r\nName: agetty\r\nPath: \"/usr/sbin/agetty\"\r\nTotal files scanned: 1\r\nScan time (ns): \"12299\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 1271\r\nName: agetty\r\nPath: \"/usr/sbin/agetty\"\r\nTotal files scanned: 1\r\nScan time (ns): \"9999\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 1296\r\nName: python3\r\nPath: \"/usr/libexec/platform-python3.6\"\r\nTotal files scanned: 639\r\nScan time (ns): \"2852327839\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 1737\r\nName: sshd\r\nPath: \"/usr/sbin/sshd\"\r\nTotal files scanned: 3\r\nScan time (ns): \"36861644\"\r\nStatus: Active\r\n=====================================\r\nProcess id: 2080\r\nName: anacron\r\nPath: \"/usr/sbin/anacron\"\r\nTotal files scanned: 3\r\nScan time (ns): \"15714307\"\r\nStatus: Active\r\n====================================="
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Event Provider Statistics",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check event provider statistics"
            },
            {
              "Type": "Description",
              "Value": "This command checks the event provider statistics for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic event-provider-statistics"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "Review the counters for various requests and events. High-value counters of process events (fork, exec) may indicate high CPU usage."
            },
            {
              "Type": "Code",
              "Value": "Timer thread triggered count: 16266\r\nEP Auto recovery count: 0\r\nBlocking open request count: 0\r\nNon-blocking open request count: 0\r\nNon-blocking close modified request count: 927\r\nAllowed request count: 0\r\nHold request count: 0\r\nDenied request count: 0\r\nTimed out request count: 0\r\nFork request count: 1065\r\nExec request count: 979\r\nExit request count: 1077\r\nUID change count: 27\r\nGID change count: 41\r\nSID change count: 15\r\nOpen process request count: 0\r\nFilesystem request count: 862\r\nLogin request count: 2\r\nNetfilter request count: 2\r\nSocket event count: 6220\r\nDropped filesystem request count: 0\r\nDropped process count: 0\r\nDropped open process request count: 0\r\nDropped kernel message count: 0\r\nDropped behavior monitoring message count: 0\r\nDropped ipc kernel message count: 0\r\nOther dropped message count: 0"
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "title": "Behavior Monitoring Statistics",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check behavior monitoring statistics"
            },
            {
              "Type": "Description",
              "Value": "This command checks the behavior monitoring statistics for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic behavior-monitoring-statistics"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "No Sample Output"
            },
            {
              "Type": "Description",
              "Value": ""
            }
          ]
        }
      ]
    },
    {
      "section": 5,
      "title": "Hot Event Sources",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check hot event sources"
            },
            {
              "Type": "Description",
              "Value": "This command checks the hot event sources for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic hot-event-sources"
            },
            {
              "Type": "Description",
              "Value": "We can run this command for both files and executables. It will generate a json file in the current directory with the number of events that occurred while the command ran."
            },
            {
              "Type": "Note",
              "Value": "The command will run indefinitely until you stop it with CTRL+C."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic hot-event-sources files"
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic hot-event-sources executables"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "Sample Output from 'sudo mdatp diagnostic hot-event-sources files'"
            },
            {
              "Type": "Code",
              "Value": "=========== Hot Event Sources ===========\r\nTop 0 hot event sources. Total Events: 0 Time: 5s. Throughput: 0events/sec\r\ncount  file path"
            },
            {
              "Type": "Note",
              "Value": "Press CTRL+C to stop the command when you have enough data."
            },
            {
              "Type": "Description",
              "Value": "We can now view the output from the generated .json file. The file will be named 'hot_event_sources_<GUID>.json'."
            },
            {
              "Type": "Code",
              "Value": "cat hot_event_source_1a1767f9-a135-40ec-8286-fc289623d0d4.json"
            },
            {
              "Type": "Code",
              "Value": "{\r\n  \"endTime\": \"1695921278458827\",\r\n  \"eventSource\": [],\r\n  \"startTime\": \"1695921273456715\",\r\n  \"totalEvent\": \"0\"\r\n}"
            },
            {
              "Type": "Description",
              "Value": "This example ran for 5 seconds and observed no events."
            },
            {
              "Type": "Description",
              "Value": "A large number of events may indicate a performance issue."
            }
          ]
        }
      ]
    },
    {
      "section": 6,
      "title": "eBPF Statistics",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check eBPF statistics"
            },
            {
              "Type": "Description",
              "Value": "This command checks the eBPF statistics for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic ebpf-statistics"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "If you have enabled eBPF, you can use this command to check the statistics."
            },
            {
              "Type": "Code",
              "Value": "Monitor 20 seconds\r\nTop file paths:\r\n/var/log/azure/Microsoft.OSTCExtensions.VMAccessForLinux : 4\r\n\r\nTop initiator paths:\r\n/usr/libexec/platform-python3.6 : 25\r\n\r\nTop syscall ids:\r\n42 : 21\r\n60 : 5\r\n59 : 5\r\n57 : 5\r\n90 : 4\r\n\r\nSession syscall ids:\r\n42 : 4784\r\n57 : 1555\r\n59 : 1388\r\n60 : 1553\r\n80 : 25\r\n81 : 3\r\n82 : 89\r\n87 : 79\r\n90 : 1070\r\n91 : 12\r\n92 : 10\r\n93 : 4\r\n105 : 40\r\n106 : 38\r\n112 : 15\r\n113 : 12\r\n114 : 10\r\n119 : 136\r\n263 : 20\r\n268 : 1\r\n\r\ninvalid_file_path_count : 0\r\n\r\ninvalid_initiator_path_count : 0\r\n\r\nfull_queue_dropped_event_count : 0"
            },
            {
              "Type": "Description",
              "Value": "The output shows the top file paths, top initiator paths, top syscall ids, session syscall ids, invalid file path count, invalid initiator path count, and full queue dropped event count."
            },
            {
              "Type": "Description",
              "Value": "If eBPF is not enabled, the output will be empty."
            },
            {
              "Type": "Code",
              "Value": "Monitor 20 seconds\r\nTop file paths:\r\n\r\nTop initiator paths:\r\n\r\nTop syscall ids:\r\n\r\ninvalid_file_path_count : 0\r\n\r\ninvalid_initiator_path_count : 0\r\n\r\nfull_queue_dropped_event_count : 0"
            }
          ]
        }
      ]
    },
    {
      "section": 7,
      "title": "Create and Upload Support Logs",
      "description": "",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Create and upload support logs"
            },
            {
              "Type": "Description",
              "Value": "This command creates and uploads support logs for Microsoft Defender for Endpoint."
            },
            {
              "Type": "Code",
              "Value": "mdatp diagnostic create"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample Output"
            },
            {
              "Type": "Description",
              "Value": "A zip file is generated in /var/opt/microsoft/mdatp/wdavdiag/ which can be uploaded to a Microsoft support case."
            },
            {
              "Type": "Code",
              "Value": "Diagnostic file created: \"/var/opt/microsoft/mdatp/wdavdiag/b30d1f0e-8c2b-4107-ae87-5381ff0433a7.zip\""
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "MDELinuxFedoraSetup", "path": "./json/MDELinuxFedoraSetup.json", "data": {
  "title": "Setup - Fedora",
  "path": "/mde/linux-setup-fedora",
  "section": "MDE",
  "subSection": "Linux",
  "description": "",
  "data": [
    {
      "section": 1,
      "title": "Checking Existing Install",
      "description": "What do we have already?",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Get Distro Version"
            },
            {
              "Type": "Description",
              "Value": "This exercie assumes you have a Linux VM setup and running Fedora."
            },
            {
              "Type": "Code",
              "Value": "cat /etc/os-release"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Example output"
            },
            {
              "Type": "Code",
              "Value": "NAME=\"Fedora Linux\"\r\nVERSION=\"38 (Thirty Eight)\"\r\nID=fedora\r\nVERSION_ID=38\r\nVERSION_CODENAME=\"\"\r\nPLATFORM_ID=\"platform:f38\"\r\nPRETTY_NAME=\"Fedora Linux 38 (Thirty Eight)\"\r\nANSI_COLOR=\"0;38;2;60;110;180\"\r\nLOGO=fedora-logo-icon\r\nCPE_NAME=\"cpe:/o:fedoraproject:fedora:38\"\r\nDEFAULT_HOSTNAME=\"fedora\"\r\nHOME_URL=\"https://fedoraproject.org/\"\r\nDOCUMENTATION_URL=\"https://docs.fedoraproject.org/en-US/fedora/f38/system-administrators-guide/\"\r\nSUPPORT_URL=\"https://ask.fedoraproject.org/\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\nREDHAT_BUGZILLA_PRODUCT=\"Fedora\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=38\r\nREDHAT_SUPPORT_PRODUCT=\"Fedora\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=38\r\nSUPPORT_END=2024-05-14"
            }
          ]
        },
        {
          "title": "Has MDATP already been installed?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check if MDATP is installed"
            },
            {
              "Type": "Code",
              "Value": "which mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Description",
              "Value": "The command will return the location of the binary/executable if it is found."
            },
            {
              "Type": "Code",
              "Value": "/usr/bin/mdatp"
            }
          ]
        },
        {
          "title": "What's the status of the daemon?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check daemon status"
            },
            {
              "Type": "Code",
              "Value": "service mdatp status"
            },
            {
              "Type": "Description",
              "Value": "The above command will only work if the daemon is installed and running."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "\u25CF mdatp.service - Microsoft Defender\r\n     Loaded: loaded (/usr/lib/systemd/system/mdatp.service; enabled; preset: disabled)\r\n    Drop-In: /usr/lib/systemd/system/service.d\r\n             \u2514\u250010-timeout-abort.conf\r\n     Active: active (running) since Tue 2023-10-03 14:07:36 EDT; 2h 24min ago\r\n   Main PID: 688 (wdavdaemon)\r\n      Tasks: 159 (limit: 4650)\r\n     Memory: 566.0M\r\n        CPU: 20.746s\r\n     CGroup: /system.slice/mdatp.service\r\n             \u251C\u2500 688 /opt/microsoft/mdatp/sbin/wdavdaemon\r\n             \u251C\u2500 738 /opt/microsoft/mdatp/sbin/wdavdaemon edr 11 10 --log_level info\r\n             \u251C\u2500 801 /opt/microsoft/mdatp/sbin/telemetryd_v2 \"32\\\"\"\r\n             \u2514\u25001149 /opt/microsoft/mdatp/sbin/wdavdaemon unprivileged 79 81 83 85 78 --log_level info"
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Envrionment Setup",
      "description": "Getting the environment ready for MDE for Linux on Fedora",
      "tasks": [
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Update system packages"
            },
            {
              "Type": "Description",
              "Value": "Update packages using the yum package manager"
            },
            {
              "Type": "Code",
              "Value": "yum update"
            },
            {
              "Type": "Note",
              "Value": "Each Linux distrobution has a different package manager. For example, Ubuntu uses apt-get, while Fedora uses yum."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "Last metadata expiration check: 1:27:18 ago on Tue 03 Oct 2023 03:06:19 PM EDT.\r\nDependencies resolved.\r\n=======================================================================================================================================================================================================================\r\n Package                                                           Architecture                        Version                                          Repository                                                Size\r\n=======================================================================================================================================================================================================================\r\nInstalling:\r\n kernel                                                            x86_64                              6.5.5-200.fc38                                   updates                                                  147 k\r\nUpgrading:\r\n amd-gpu-firmware                                                  noarch                              20230919-1.fc38                                  updates                                                   19 M\r\n atheros-firmware                                                  noarch                              20230919-1.fc38                                  updates                                                   20 M\r\n authselect                                                        x86_64                              1.4.3-1.fc38                                     updates                                                  149 k\r\n authselect-libs                                                   x86_64                              1.4.3-1.fc38                                     updates                                                  249 k\r\n azure-cli                                                         noarch                              2.52.0-1.fc38                                    updates                                                   12 M\r\n bluez                                                             x86_64                              5.70-1.fc38                                      updates                                                  1.1 M\r\n brcmfmac-firmware                                                 noarch                              20230919-1.fc38                                  updates                                                  9.6 M\r\n cloud-utils-growpart                                              noarch                              0.33-3.fc38                                      updates                                                   34 k\r\n curl                                                              x86_64                              8.0.1-4.fc38                                     updates                                                  349 k\r\n dbus                                                              x86_64                              1:1.14.10-1.fc38                                 updates                                                  8.0 k\r\n dbus-common                                                       noarch                              1:1.14.10-1.fc38                                 updates                                                   15 k\r\n dbus-libs                                                         x86_64                              1:1.14.10-1.fc38                                 updates                                                  156 k\r\n fwupd                                                             x86_64                              1.9.5-1.fc38                                     updates                                                  2.0 M\r\n glib2                                                             x86_64                              2.76.5-2.fc38                                    updates                                                  2.8 M\r\n glibc                                                             x86_64                              2.37-5.fc38                                      updates                                                  2.1 M\r\n glibc-common                                                      x86_64                              2.37-5.fc38                                      updates                                                  315 k\r\n glibc-gconv-extra                                                 x86_64                              2.37-5.fc38                                      updates                                                  1.6 M\r\n glibc-langpack-en                                                 x86_64                              2.37-5.fc38                                      updates                                                  633 k\r\n gnutls                                                            x86_64                              3.8.1-1.fc38                                     updates                                                  1.1 M\r\n grub2-common                                                      noarch                              1:2.06-100.fc38                                  updates                                                  918 k\r\n grub2-pc                                                          x86_64                              1:2.06-100.fc38                                  updates                                                   17 k\r\n grub2-pc-modules                                                  noarch                              1:2.06-100.fc38                                  updates                                                  1.1 M\r\n grub2-tools                                                       x86_64                              1:2.06-100.fc38                                  updates                                                  1.8 M\r\n grub2-tools-minimal                                               x86_64                              1:2.06-100.fc38                                  updates                                                  622 k\r\n intel-gpu-firmware                                                noarch                              20230919-1.fc38                                  updates                                                  8.7 M\r\n iproute                                                           x86_64                              6.4.0-1.fc38                                     updates                                                  815 k\r\n libcap-ng                                                         x86_64                              0.8.3-8.fc38                                     updates                                                   32 k\r\n libcurl                                                           x86_64                              8.0.1-4.fc38                                     updates                                                  313 k\r\n libeconf                                                          x86_64                              0.5.2-1.fc38                                     updates                                                   30 k\r\n libxmlb                                                           x86_64                              0.3.14-1.fc38                                    updates                                                  117 k\r\n linux-firmware                                                    noarch                              20230919-1.fc38                                  updates                                                   54 M\r\n linux-firmware-whence                                             noarch                              20230919-1.fc38                                  updates                                                   48 k\r\n mdatp                                                             x86_64                              101.23072.0021-1                                 packages-microsoft-com-prod                              127 M\r\n mt7xxx-firmware                                                   noarch                              20230919-1.fc38                                  updates                                                  7.2 M\r\n nspr                                                              x86_64                              4.35.0-10.fc38                                   updates                                                  136 k\r\n nss                                                               x86_64                              3.93.0-1.fc38                                    updates                                                  695 k\r\n nss-softokn                                                       x86_64                              3.93.0-1.fc38                                    updates                                                  1.0 M\r\n nss-softokn-freebl                                                x86_64                              3.93.0-1.fc38                                    updates                                                  326 k\r\n nss-sysinit                                                       x86_64                              3.93.0-1.fc38                                    updates                                                   18 k\r\n nss-util                                                          x86_64                              3.93.0-1.fc38                                    updates                                                   86 k\r\n nvidia-gpu-firmware                                               noarch                              20230919-1.fc38                                  updates                                                  1.2 M\r\n openldap                                                          x86_64                              2.6.6-1.fc38                                     updates                                                  254 k\r\n python3                                                           x86_64                              3.11.5-1.fc38                                    updates                                                   28 k\r\n python3-azure-batch                                               noarch                              14.0.0-2.fc38                                    updates                                                  224 k\r\n python3-azure-cli-core                                            noarch                              2.52.0-1.fc38                                    updates                                                  598 k\r\n python3-azure-cli-telemetry                                       noarch                              2.52.0-1.fc38                                    updates                                                   49 k\r\n python3-azure-mgmt-authorization                                  noarch                              1:4.0.0-1.fc38                                   updates                                                  920 k\r\n python3-azure-mgmt-cognitiveservices                              noarch                              13.5.0-2.fc38                                    updates                                                  206 k\r\n python3-azure-mgmt-compute                                        noarch                              1:30.0.0-2.fc38                                  updates                                                  2.7 M\r\n python3-azure-mgmt-containerservice                               noarch                              26.0.0-1.fc38                                    updates                                                  2.9 M\r\n python3-azure-mgmt-keyvault                                       noarch                              10.2.3-1.fc38                                    updates                                                  552 k\r\n python3-azure-mgmt-policyinsights                                 noarch                              1:1.1.0~b4-2.fc38                                updates                                                  205 k\r\n python3-azure-mgmt-redhatopenshift                                noarch                              1:1.3.0-1.fc38                                   updates                                                  276 k\r\n python3-azure-mgmt-security                                       noarch                              1:5.0.0-2.fc38                                   updates                                                  1.1 M\r\n python3-azure-mgmt-sql                                            noarch                              1:4.0.0~b12-1.fc38                               updates                                                  991 k\r\n python3-azure-synapse-artifacts                                   noarch                              1:0.17.0-2.fc38                                  updates                                                  548 k\r\n python3-knack                                                     noarch                              1:0.11.0-1.fc38                                  updates                                                  160 k\r\n python3-libs                                                      x86_64                              3.11.5-1.fc38                                    updates                                                  9.6 M\r\n python3-msal                                                      noarch                              1.24.0~b1-9.fc38                                 updates                                                  172 k\r\n python3-msal+broker                                               noarch                              1.24.0~b1-9.fc38                                 updates                                                  9.8 k\r\n python3-oauthlib                                                  noarch                              3.2.2-1.fc38                                     updates                                                  247 k\r\n python3-setools                                                   x86_64                              4.4.3-1.fc38                                     updates                                                  624 k\r\n realtek-firmware                                                  noarch                              20230919-1.fc38                                  updates                                                  2.4 M\r\n rpm-sequoia                                                       x86_64                              1.5.0-1.fc38                                     updates                                                  884 k\r\n selinux-policy                                                    noarch                              38.28-1.fc38                                     updates                                                   54 k\r\n selinux-policy-targeted                                           noarch                              38.28-1.fc38                                     updates                                                  6.7 M\r\n systemd                                                           x86_64                              253.10-1.fc38                                    updates                                                  4.4 M\r\n systemd-libs                                                      x86_64                              253.10-1.fc38                                    updates                                                  652 k\r\n systemd-pam                                                       x86_64                              253.10-1.fc38                                    updates                                                  340 k\r\n systemd-resolved                                                  x86_64                              253.10-1.fc38                                    updates                                                  289 k\r\n systemd-udev                                                      x86_64                              253.10-1.fc38                                    updates                                                  2.1 M\r\n traceroute                                                        x86_64                              3:2.1.3-1.fc38                                   updates                                                   57 k\r\n vim-common                                                        x86_64                              2:9.0.1927-1.fc38                                updates                                                  7.7 M\r\n vim-data                                                          noarch                              2:9.0.1927-1.fc38                                updates                                                   23 k\r\n vim-default-editor                                                noarch                              2:9.0.1927-1.fc38                                updates                                                   16 k\r\n vim-enhanced                                                      x86_64                              2:9.0.1927-1.fc38                                updates                                                  1.9 M\r\n vim-filesystem                                                    noarch                              2:9.0.1927-1.fc38                                updates                                                   18 k\r\n vim-minimal                                                       x86_64                              2:9.0.1927-1.fc38                                updates                                                  799 k\r\n xxd                                                               x86_64                              2:9.0.1927-1.fc38                                updates                                                   36 k\r\nInstalling dependencies:\r\n kernel-core                                                       x86_64                              6.5.5-200.fc38                                   updates                                                   16 M\r\n kernel-modules                                                    x86_64                              6.5.5-200.fc38                                   updates                                                   57 M\r\n kernel-modules-core                                               x86_64                              6.5.5-200.fc38                                   updates                                                   31 M\r\n\r\nTransaction Summary\r\n=======================================================================================================================================================================================================================\r\nInstall   4 Packages\r\nUpgrade  79 Packages\r\n\r\nTotal download size: 434 M\r\nIs this ok [y/N]:"
            }
          ]
        },
        {
          "title": "Install yum-utils",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Install yum-utils"
            },
            {
              "Type": "Description",
              "Value": "yum-utils is a package that provides a collection of utilities and commands to enhance the functionality of the yum package manager"
            },
            {
              "Type": "Code",
              "Value": "yum install yum-utils"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "Last metadata expiration check: 1:48:29 ago on Tue 03 Oct 2023 03:06:19 PM EDT.\r\nDependencies resolved.\r\n=======================================================================================================================================================================================================================\r\n Package                                             Architecture                                     Version                                                  Repository                                         Size\r\n=======================================================================================================================================================================================================================\r\nInstalling:\r\n dnf-utils                                           noarch                                           4.4.2-1.fc38                                             updates                                            36 k\r\n\r\nTransaction Summary\r\n=======================================================================================================================================================================================================================\r\nInstall  1 Package\r\n\r\nTotal download size: 36 k\r\nInstalled size: 23 k\r\nIs this ok [y/N]: y\r\nDownloading Packages:\r\ndnf-utils-4.4.2-1.fc38.noarch.rpm                                                                                                                                                      146 kB/s |  36 kB     00:00\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTotal                                                                                                                                                                                   48 kB/s |  36 kB     00:00\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Preparing        :                                                                                                                                                                                               1/1\r\n  Installing       : dnf-utils-4.4.2-1.fc38.noarch                                                                                                                                                                 1/1\r\n  Running scriptlet: dnf-utils-4.4.2-1.fc38.noarch                                                                                                                                                                 1/1\r\n  Verifying        : dnf-utils-4.4.2-1.fc38.noarch                                                                                                                                                                 1/1\r\n\r\nInstalled:\r\n  dnf-utils-4.4.2-1.fc38.noarch\r\n\r\nComplete!"
            }
          ]
        },
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Add the Microsoft repo to isntall MDE"
            },
            {
              "Type": "Code",
              "Value": "yum-config-manager --add-repo=https://packages.microsoft.com/config/fedora/38/prod.repo"
            },
            {
              "Type": "Description",
              "Value": "You can view the different repos available at https://packages.microsoft.com/config/fedora/"
            },
            {
              "Type": "Description",
              "Value": "Select your distro and version to see the repo information."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample yum update output"
            },
            {
              "Type": "Description",
              "Value": "The Fedora package repository will be added to the system. This will allow you to install MDE using yum."
            },
            {
              "Type": "Description",
              "Value": "The output below shows the RPM package being added to the system."
            },
            {
              "Type": "Code",
              "Value": "Adding repo from: https://packages.microsoft.com/config/fedora/38/prod.repo"
            },
            {
              "Type": "Title",
              "Value": "Sample repo packages"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/FedoraRepos.png"
            }
          ]
        },
        {
          "title": "Update packages and repos",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check the respoiory list to see if the Microsoft repo has been added"
            },
            {
              "Type": "Code",
              "Value": "sudo dnf repolist | grep microsoft"
            },
            {
              "Type": "Description",
              "Value": "OR"
            },
            {
              "Type": "Code",
              "Value": "yum repolist | grep microsoft"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample dnf output"
            },
            {
              "Type": "Code",
              "Value": "packages-microsoft-com-prod       packages-microsoft-com-prod"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Install MDE for Linux",
      "description": "Steps to install the MDE for Linux agent on Fedora",
      "tasks": [
        {
          "title": "Install the MDE package.",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Install MDE"
            },
            {
              "Type": "Code",
              "Value": "sudo yum install mdatp"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "yum install mdatp\r\nLast metadata expiration check: 0:03:55 ago on Tue 03 Oct 2023 06:10:54 PM EDT.\r\nDependencies resolved.\r\n=======================================================================================================================================================================================================================\r\n Package                                              Architecture                             Version                                             Repository                                                     Size\r\n=======================================================================================================================================================================================================================\r\nInstalling:\r\n mdatp                                                x86_64                                   101.23072.0021-1                                    packages-microsoft-com-prod                                   127 M\r\nInstalling dependencies:\r\n libnetfilter_queue                                   x86_64                                   1.0.5-4.fc38                                        fedora                                                         28 k\r\n mde-netfilter                                        x86_64                                   100.69.62-1                                         packages-microsoft-com-prod                                    35 k\r\n\r\nTransaction Summary\r\n=======================================================================================================================================================================================================================\r\nInstall  3 Packages\r\n\r\nTotal download size: 127 M\r\nInstalled size: 378 M\r\nIs this ok [y/N]: y\r\nDownloading Packages:\r\n(1/3): libnetfilter_queue-1.0.5-4.fc38.x86_64.rpm                                                                                                                                       71 kB/s |  28 kB     00:00\r\n(2/3): mde-netfilter_100.69.62.x86_64.rpm                                                                                                                                               60 kB/s |  35 kB     00:00\r\n(3/3): mdatp_101.23072.0021.x86_64.rpm                                                                                                                                                  21 MB/s | 127 MB     00:06\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTotal                                                                                                                                                                                   19 MB/s | 127 MB     00:06\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Running scriptlet: mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              1/1\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 1/1\r\n  Preparing        :                                                                                                                                                                                               1/1\r\n  Installing       : libnetfilter_queue-1.0.5-4.fc38.x86_64                                                                                                                                                        1/3\r\n  Running scriptlet: mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              2/3\r\nNew installation\r\n\r\n  Installing       : mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              2/3\r\n  Running scriptlet: mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              2/3\r\nConfigure: Starting MDE Netfilter socket based activation\r\nCreated symlink /etc/systemd/system/sockets.target.wants/mde_netfilter.socket \u2192 /usr/lib/systemd/system/mde_netfilter.socket.\r\nCreated symlink /etc/systemd/system/multi-user.target.wants/mde_netfilter.service \u2192 /usr/lib/systemd/system/mde_netfilter.service.\r\n\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 3/3\r\n  Installing       : mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 3/3\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 3/3\r\n  Running scriptlet: mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              3/3\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 3/3\r\n  Verifying        : libnetfilter_queue-1.0.5-4.fc38.x86_64                                                                                                                                                        1/3\r\n  Verifying        : mdatp-101.23072.0021-1.x86_64                                                                                                                                                                 2/3\r\n  Verifying        : mde-netfilter-100.69.62-1.x86_64                                                                                                                                                              3/3\r\n\r\nInstalled:\r\n  libnetfilter_queue-1.0.5-4.fc38.x86_64                                      mdatp-101.23072.0021-1.x86_64                                      mde-netfilter-100.69.62-1.x86_64\r\n\r\nComplete!"
            },
            {
              "Type": "Title",
              "Value": "We can view the logs for this installation in /var/log/microsoft/mdatp/install.log"
            },
            {
              "Type": "Code",
              "Value": "cat /var/log/microsoft/mdatp/install.log"
            },
            {
              "Type": "Note",
              "Value": "The 'cat' command will print the file to the screen. You can also use 'less' to view the file."
            },
            {
              "Type": "Code",
              "Value": "preinstall\r\nArguments passed to the preinstall script: 1\r\npreinstall begin [2023-10-03 18:15:04OURCE -0400] 13234\r\ncorrelation id=a5617ab3-b20a-4a18-804d-bf9342270745\r\nGeneration installation id\r\nis_new_install=1, bundle_version=101.23072.0021, branch=release/linux/2307-2\r\nFile /opt/microsoft/mdatp/conf/BuildInfo not found\r\nNAME=\"Fedora Linux\"\r\nVERSION=\"38 (Thirty Eight)\"\r\nID=fedora\r\nVERSION_ID=38\r\nVERSION_CODENAME=\"\"\r\nPLATFORM_ID=\"platform:f38\"\r\nPRETTY_NAME=\"Fedora Linux 38 (Thirty Eight)\"\r\nANSI_COLOR=\"0;38;2;60;110;180\"\r\nLOGO=fedora-logo-icon\r\nCPE_NAME=\"cpe:/o:fedoraproject:fedora:38\"\r\nDEFAULT_HOSTNAME=\"fedora\"\r\nHOME_URL=\"https://fedoraproject.org/\"\r\nDOCUMENTATION_URL=\"https://docs.fedoraproject.org/en-US/fedora/f38/system-administrators-guide/\"\r\nSUPPORT_URL=\"https://ask.fedoraproject.org/\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\nREDHAT_BUGZILLA_PRODUCT=\"Fedora\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=38\r\nREDHAT_SUPPORT_PRODUCT=\"Fedora\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=38\r\nSUPPORT_END=2024-05-14\r\nDISTRO: fedora\r\nDISTRO_VERSION: 38\r\nDISTRO_FAMILY: fedora\r\nScenario= Install\r\n/var/tmp/rpm-tmp.YCKZ5g: line 526: dmidecode: command not found\r\nMachine Guid: e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\r\nCreating daemon user\r\nDaemon user (mdatp) created successfully\r\nLogging pending telemetry\r\n[LogTelemetry] Submitting {\r\n        \"client\": {\r\n            \"appVersion\": \"101.23072.0021\",\r\n            \"hostname\": \"Fedora-01\",\r\n            \"platform\": \"Linux\",\r\n            \"machineGuid\": \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\",\r\n            \"orgId\": \"\",\r\n            \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\r\n        },\r\n        \"reports\":[\r\n            {\r\n                \"$type\":\"installationReport\",\r\n                \"correlation_id\": \"a5617ab3-b20a-4a18-804d-bf9342270745\",\r\n                \"version\": \"101.23072.0021\",\r\n                \"severity\": \"W\",\r\n                \"code\":\"FileNotExist\",\r\n                \"text\":\"File /opt/microsoft/mdatp/conf/BuildInfo not found\"\r\n            }\r\n        ]\r\n    }\r\nTelemetry Submitted\r\n[LogTelemetry] result=0\r\n[LogTelemetry] Submitting {\r\n        \"client\": {\r\n            \"appVersion\": \"101.23072.0021\",\r\n            \"hostname\": \"Fedora-01\",\r\n            \"platform\": \"Linux\",\r\n            \"machineGuid\": \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\",\r\n            \"orgId\": \"\",\r\n            \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\r\n        },\r\n        \"reports\":[\r\n            {\r\n                \"$type\":\"installationReport\",\r\n                \"correlation_id\": \"a5617ab3-b20a-4a18-804d-bf9342270745\",\r\n                \"version\": \"101.23072.0021\",\r\n                \"severity\": \"I\",\r\n                \"code\":\"InstallStarted\",\r\n                \"text\":\"is_new_install='1', bundle_version='101.23072.0021', branch='release/linux/2307-2', package=''\"\r\n            }\r\n        ]\r\n    }\r\nTelemetry Submitted\r\n[LogTelemetry] result=0\r\n[LogTelemetry] Submitting {\r\n        \"client\": {\r\n            \"appVersion\": \"101.23072.0021\",\r\n            \"hostname\": \"Fedora-01\",\r\n            \"platform\": \"Linux\",\r\n            \"machineGuid\": \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\",\r\n            \"orgId\": \"\",\r\n            \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\r\n        },\r\n        \"reports\":[\r\n            {\r\n                \"$type\":\"installationReport\",\r\n                \"correlation_id\": \"a5617ab3-b20a-4a18-804d-bf9342270745\",\r\n                \"version\": \"101.23072.0021\",\r\n                \"severity\": \"W\",\r\n                \"code\":\"ComponentNotFound\",\r\n                \"text\":\"crontab command not found\"\r\n            }\r\n        ]\r\n    }\r\nTelemetry Submitted\r\n[LogTelemetry] result=0\r\npreinstall end [2023-10-03 18:15:05OURCE -0400] 13234\r\npostinstall\r\nArguments passed to the postinstall script: 1\r\npostinstall begin [2023-10-03 18:15:09OURCE -0400] 13234\r\nTrying to auto configure bash-completion at /usr/share/bash-completion/completions\r\nTrying to auto configure zsh-completion at /usr/share/zsh/vendor-completions\r\nzsh-completion is not installed at /usr/share/zsh/vendor-completions, auto-complete cannot be configured\r\nTrying to auto configure zsh-completion at /usr/share/zsh/site-functions\r\nNAME=\"Fedora Linux\"\r\nVERSION=\"38 (Thirty Eight)\"\r\nID=fedora\r\nVERSION_ID=38\r\nVERSION_CODENAME=\"\"\r\nPLATFORM_ID=\"platform:f38\"\r\nPRETTY_NAME=\"Fedora Linux 38 (Thirty Eight)\"\r\nANSI_COLOR=\"0;38;2;60;110;180\"\r\nLOGO=fedora-logo-icon\r\nCPE_NAME=\"cpe:/o:fedoraproject:fedora:38\"\r\nDEFAULT_HOSTNAME=\"fedora\"\r\nHOME_URL=\"https://fedoraproject.org/\"\r\nDOCUMENTATION_URL=\"https://docs.fedoraproject.org/en-US/fedora/f38/system-administrators-guide/\"\r\nSUPPORT_URL=\"https://ask.fedoraproject.org/\"\r\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\r\nREDHAT_BUGZILLA_PRODUCT=\"Fedora\"\r\nREDHAT_BUGZILLA_PRODUCT_VERSION=38\r\nREDHAT_SUPPORT_PRODUCT=\"Fedora\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=38\r\nSUPPORT_END=2024-05-14\r\nDISTRO: fedora\r\nDISTRO_VERSION: 38\r\nDISTRO_FAMILY: fedora\r\nScenario= Install\r\n/var/tmp/rpm-tmp.r1k54o: line 527: dmidecode: command not found\r\nMachine Guid: e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\r\ncorrelation id=a5617ab3-b20a-4a18-804d-bf9342270745\r\nPackage version being installed= 101.23072.0021\r\nInstalling MDATP SELinux policy\r\nInstalling MDATP SELinux policy for non-RHEL7.6 systems\r\nSetting SElinux bool audisp_mdatp_from_audisp_t off\r\nSetting SElinux bool audisp_mdatp_from_auditd_t on\r\nSetting SELinux labels\r\nRelease ring: Production\r\nCreating Crash Reports Path: /var/opt/microsoft/mdatp/crash\r\nChecking if patched libauparse\r\nAUDITD Version = 3.1.2\r\nCreating soft link for libfuse if it doesn't exists\r\nCleanup empty auditd configuration files\r\n/etc/audit/rules.d/mdatp.rules path does not exist or not a regular file\r\n/etc/audisp/plugins.d/mdatp.conf path does not exist or not a regular file\r\n/etc/audit/plugins.d/mdatp.conf path does not exist or not a regular file\r\nSetting q_depth and buffer_limit of auditd\r\nAuditd q_depth configuration file is /etc/audit/auditd.conf\r\n[>] q_depth updated to 400\r\ngrep: warning: stray \\ before -\r\n[>] buffer_limit updated to 10240\r\n/sbin/augenrules: No change\r\nNo rules\r\nenabled 1\r\nfailure 1\r\npid 607\r\nrate_limit 0\r\nbacklog_limit 10240\r\nlost 0\r\nbacklog 0\r\nbacklog_wait_time 60000\r\nbacklog_wait_time_actual 0\r\naugenrules rules loaded successfully\r\nReconfiguring: /sbin/augenrules: No change\r\nNo rules\r\nenabled 1\r\nfailure 1\r\npid 607\r\nrate_limit 0\r\nbacklog_limit 10240\r\nlost 0\r\nbacklog 0\r\nbacklog_wait_time 60000\r\nbacklog_wait_time_actual 0\r\n\r\nauditd reloaded successfully\r\nCreating soft link of libpcre if it doesn't exists\r\nStarting wdavdaemon\r\nCreated symlink /etc/systemd/system/multi-user.target.wants/mdatp.service \u2192 /usr/lib/systemd/system/mdatp.service.\r\n[LogTelemetry] Submitting {\r\n        \"client\": {\r\n            \"appVersion\": \"101.23072.0021\",\r\n            \"hostname\": \"Fedora-01\",\r\n            \"platform\": \"Linux\",\r\n            \"machineGuid\": \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\",\r\n            \"orgId\": \"\",\r\n            \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\r\n        },\r\n        \"reports\":[\r\n            {\r\n                \"$type\":\"installationReport\",\r\n                \"correlation_id\": \"a5617ab3-b20a-4a18-804d-bf9342270745\",\r\n                \"version\": \"101.23072.0021\",\r\n                \"severity\": \"I\",\r\n                \"code\":\"DaemonInitialized\",\r\n                \"text\":\"\"\r\n            }\r\n        ]\r\n    }\r\nTelemetry Submitted\r\n[LogTelemetry] result=0\r\nDaemon initialization completed\r\nDaemon status:\r\nactive\r\nwdavdaemon is running, pid=13658\r\nChecking mdatp health\r\nMDATP onboarded = ATTENTION: No license found. Contact your administrator for help.\r\nfalse\r\nMDATP not Healthy! Health issues: ATTENTION: No license found. Contact your administrator for help.\r\nhealthy                                     : false\r\nhealth_issues                               : [\"missing license\"]\r\nlicensed                                    : false\r\nengine_version                              : \"1.1.20100.7\"\r\napp_version                                 : \"101.23072.0021\"\r\norg_id                                      : \"\"\r\nlog_level                                   : \"info\"\r\nmachine_guid                                : \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\"\r\nrelease_ring                                : \"Production\"\r\nproduct_expiration                          : unavailable\r\ncloud_enabled                               : true\r\ncloud_automatic_sample_submission_consent   : \"safe\"\r\ncloud_diagnostic_enabled                    : false\r\npassive_mode_enabled                        : true\r\nbehavior_monitoring                         : \"disabled\"\r\nreal_time_protection_enabled                : false\r\nreal_time_protection_available              : true\r\nreal_time_protection_subsystem              : \"fanotify\"\r\nsupplementary_events_subsystem              : \"auditd\"\r\ntamper_protection                           : \"disabled\"\r\nautomatic_definition_update_enabled         : true\r\ndefinitions_updated                         : Oct 03, 2023 at 06:15:09 PM\r\ndefinitions_updated_minutes_ago             : 0\r\ndefinitions_version                         : \"1.385.1648.0\"\r\ndefinitions_status                          : \"checking_for_updates\"\r\nedr_early_preview_enabled                   : \"disabled\"\r\nedr_device_tags                             : []\r\nedr_group_ids                               : \"\"\r\nedr_configuration_version                   : unavailable\r\nedr_machine_id                              : \"a709d89d7e8d299de9f0b9d173e3f1cdf4672284\"\r\nconflicting_applications                    : []\r\nnetwork_protection_status                   : \"stopped\"\r\nnetwork_protection_enforcement_level        : \"disabled\"\r\ntroubleshooting_mode                        : false\r\n[LogTelemetry] Submitting {\r\n        \"client\": {\r\n            \"appVersion\": \"101.23072.0021\",\r\n            \"hostname\": \"Fedora-01\",\r\n            \"platform\": \"Linux\",\r\n            \"machineGuid\": \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\",\r\n            \"orgId\": \"\",\r\n            \"productGuid\":\"c65eac3e-401e-4a0c-82e3-f106f693222f\"\r\n        },\r\n        \"reports\":[\r\n            {\r\n                \"$type\":\"installationReport\",\r\n                \"correlation_id\": \"a5617ab3-b20a-4a18-804d-bf9342270745\",\r\n                \"version\": \"101.23072.0021\",\r\n                \"severity\": \"E\",\r\n                \"code\":\"Install\",\r\n                \"text\":\"health_issue='ATTENTION: No license found. Contact your administrator for help.\r\nhealthy                                     : false\r\nhealth_issues                               : [\"missing license\"]\r\nlicensed                                    : false\r\nengine_version                              : \"1.1.20100.7\"\r\napp_version                                 : \"101.23072.0021\"\r\norg_id                                      : \"\"\r\nlog_level                                   : \"info\"\r\nmachine_guid                                : \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\"\r\nrelease_ring                                : \"Production\"\r\nproduct_expiration                          : unavailable\r\ncloud_enabled                               : true\r\ncloud_automatic_sample_submission_consent   : \"safe\"\r\ncloud_diagnostic_enabled                    : false\r\npassive_mode_enabled                        : true\r\nbehavior_monitoring                         : \"disabled\"\r\nreal_time_protection_enabled                : false\r\nreal_time_protection_available              : true\r\nreal_time_protection_subsystem              : \"fanotify\"\r\nsupplementary_events_subsystem              : \"auditd\"\r\ntamper_protection                           : \"disabled\"\r\nautomatic_definition_update_enabled         : true\r\ndefinitions_updated                         : Oct 03, 2023 at 06:15:09 PM\r\ndefinitions_updated_minutes_ago             : 0\r\ndefinitions_version                         : \"1.385.1648.0\"\r\ndefinitions_status                          : \"checking_for_updates\"\r\nedr_early_preview_enabled                   : \"disabled\"\r\nedr_device_tags                             : []\r\nedr_group_ids                               : \"\"\r\nedr_configuration_version                   : unavailable\r\nedr_machine_id                              : \"a709d89d7e8d299de9f0b9d173e3f1cdf4672284\"\r\nconflicting_applications                    : []\r\nnetwork_protection_status                   : \"stopped\"\r\nnetwork_protection_enforcement_level        : \"disabled\"\r\ntroubleshooting_mode                        : false'\"\r\n            }\r\n        ]\r\n    }\r\nTelemetry Submitted\r\n[LogTelemetry] result=0\r\npostinstall end [2023-10-03 18:15:32OURCE -0400] 13234"
            },
            {
              "Type": "Description",
              "Value": "We can also use `grep` to search for specific text in the file."
            },
            {
              "Type": "Code",
              "Value": "cat /var/log/microsoft/mdatp/install.log | grep VERSION_ID"
            },
            {
              "Type": "Note",
              "Value": "You could try replacing VERSION_ID with 'error', 'exception' or 'failed' when troubleshooting."
            },
            {
              "Type": "Code",
              "Value": "VERSION_ID=\"8\""
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "title": "Explore the MDATP application",
      "description": "Let's check the configuration of the MDE for Linux agent",
      "tasks": [
        {
          "title": "Health check",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Health check"
            },
            {
              "Type": "Code",
              "Value": "mdatp health"
            },
            {
              "Type": "Note",
              "Value": "The 'mdatp health' command will show the health of the MDE for Linux agent. This will show if the agent is healthy, if there are any health issues, if the agent is licensed, and configurations values."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "ATTENTION: No license found. Contact your administrator for help.\r\nhealthy                                     : false\r\nhealth_issues                               : [\"missing license\"]\r\nlicensed                                    : false\r\nengine_version                              : \"1.1.23080.2007\"\r\napp_version                                 : \"101.23072.0021\"\r\norg_id                                      : \"\"\r\nlog_level                                   : \"info\"\r\nmachine_guid                                : \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\"\r\nrelease_ring                                : \"Production\"\r\nproduct_expiration                          : unavailable\r\ncloud_enabled                               : true\r\ncloud_automatic_sample_submission_consent   : \"safe\"\r\ncloud_diagnostic_enabled                    : false\r\npassive_mode_enabled                        : true\r\nbehavior_monitoring                         : \"disabled\"\r\nreal_time_protection_enabled                : false\r\nreal_time_protection_available              : true\r\nreal_time_protection_subsystem              : \"fanotify\"\r\nsupplementary_events_subsystem              : \"auditd\"\r\ntamper_protection                           : \"disabled\"\r\nautomatic_definition_update_enabled         : true\r\ndefinitions_updated                         : Oct 03, 2023 at 06:15:39 PM\r\ndefinitions_updated_minutes_ago             : 5\r\ndefinitions_version                         : \"1.397.2014.0\"\r\ndefinitions_status                          : \"up_to_date\"\r\nedr_early_preview_enabled                   : \"disabled\"\r\nedr_device_tags                             : []\r\nedr_group_ids                               : \"\"\r\nedr_configuration_version                   : unavailable\r\nedr_machine_id                              : \"a709d89d7e8d299de9f0b9d173e3f1cdf4672284\"\r\nconflicting_applications                    : []\r\nnetwork_protection_status                   : \"stopped\"\r\nnetwork_protection_enforcement_level        : \"disabled\"\r\ntroubleshooting_mode                        : false"
            },
            {
              "Type": "Description",
              "Value": "In this case we can see a licensing error. We need to run the onboarding script to register the agent with the MDATP service."
            }
          ]
        }
      ]
    },
    {
      "section": 5,
      "title": "Configure MDATP",
      "description": "Configure MDATP",
      "tasks": [
        {
          "title": "Download the onbarding script",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Download the onbarding script"
            },
            {
              "Type": "Description",
              "Value": "Go to https://security.microsoft.com/securitysettings/endpoints"
            },
            {
              "Type": "Note",
              "Value": "Make sure you have the correct permissions and licenses. You will need to be a Global Administrator or Security Administrator to access this page."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/SecurityPortalEndpoints.png"
            }
          ]
        },
        {
          "title": "Download the onbarding script - continued",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Download the onbarding script - continued"
            },
            {
              "Type": "Description",
              "Value": "Select Onboarding under Device management."
            },
            {
              "Type": "Description",
              "Value": "Then Select Linux Server from the drop list of operating systems."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/SecurityPortalOnboarding.png"
            },
            {
              "Type": "Description",
              "Value": "Downlaod the onboarding package"
            }
          ]
        },
        {
          "title": "Optional - Copy the onboarding script to the Linux server",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Optional - Copy the onboarding script to the Linux server"
            },
            {
              "Type": "Description",
              "Value": "If you are running Windows with Windows Subsystem for Linux (WSL) you can copy the onboarding script to the Linux server using the following command."
            },
            {
              "Type": "Code",
              "Value": "scp -i C:\\Users\\masontorres\\.ssh\\id_rsa\\linkp.key 'C:\\Users\\masontorres\\Downloads\\WindowsDefenderATPOnboardingPackage.zip' labmin@10.5.1.4:~"
            },
            {
              "Type": "Description",
              "Value": "The above command is using a certificate to authenitcate to the Linux server. You can also use a username and password."
            },
            {
              "Type": "Description",
              "Value": "The file copied is stored in the home directory of the user you are authenticating as."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "WindowsDefenderATPOnboardingPackage.zip                                               100% 5472   533.9KB/s   00:00"
            }
          ]
        },
        {
          "title": "Optional - Unzip the onbard script",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Optional - Unzip the onbard script"
            },
            {
              "Type": "Description",
              "Value": "From the folder where you have copied the onboarding script."
            },
            {
              "Type": "Code",
              "Value": "cd /home/labmin/\r\nunzip WindowsDefenderATPOnboardingPackage.zip"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "Archive:  WindowsDefenderATPOnboardingPackage.zip\r\ninflating: MicrosoftDefenderATPOnboardingLinuxServer.py"
            }
          ]
        },
        {
          "title": "Client Confguration - Check org_id",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Client Confguration - Check org_id"
            },
            {
              "Type": "Description",
              "Value": "Let's check the current org_id configuration of the MDE for Linux agent."
            },
            {
              "Type": "Code",
              "Value": "mdatp health --field org_id"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "ATTENTION: No license found. Contact your administrator for help."
            }
          ]
        },
        {
          "title": "Client Confguration - Onboard",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Client Confguration - Onboard"
            },
            {
              "Type": "Description",
              "Value": "From the folder where you have copied the onboarding script. Run the python onboading script."
            },
            {
              "Type": "Code",
              "Value": "python3 MicrosoftDefenderATPOnboardingLinuxServer.py"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "Generating /etc/opt/microsoft/mdatp/mdatp_onboard.json ..."
            }
          ]
        },
        {
          "title": "Client Confguration - Confirmation",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Client Confguration - Confirmation"
            },
            {
              "Type": "Description",
              "Value": "Check MDATP health"
            },
            {
              "Type": "Code",
              "Value": "mdatp health"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "healthy                                     : true\r\nhealth_issues                               : []\r\nlicensed                                    : true\r\nengine_version                              : \"1.1.23080.2007\"\r\napp_version                                 : \"101.23072.0021\"\r\norg_id                                      : \"e1fb4f0a-1fbe-4181-b3e3-180f6e6ac31f\"\r\nlog_level                                   : \"info\"\r\nmachine_guid                                : \"e59f7ac2-0ca7-1347-9bc1-48c3d73a67c9\"\r\nrelease_ring                                : \"Production\"\r\nproduct_expiration                          : May 16, 2024 at 10:55:42 AM\r\ncloud_enabled                               : true\r\ncloud_automatic_sample_submission_consent   : \"safe\"\r\ncloud_diagnostic_enabled                    : false\r\npassive_mode_enabled                        : true\r\nbehavior_monitoring                         : \"disabled\"\r\nreal_time_protection_enabled                : false\r\nreal_time_protection_available              : true\r\nreal_time_protection_subsystem              : \"fanotify\"\r\nsupplementary_events_subsystem              : \"auditd\"\r\ntamper_protection                           : \"disabled\"\r\nautomatic_definition_update_enabled         : true\r\ndefinitions_updated                         : Oct 03, 2023 at 06:15:39 PM\r\ndefinitions_updated_minutes_ago             : 33\r\ndefinitions_version                         : \"1.397.2014.0\"\r\ndefinitions_status                          : \"up_to_date\"\r\nedr_early_preview_enabled                   : \"disabled\"\r\nedr_device_tags                             : []\r\nedr_group_ids                               : \"\"\r\nedr_configuration_version                   : \"30.199999.icm427805946.2023.10.02.03-0C3FED03EA3B36755D1B6AB19F1D98A07FA2499548B0B96833AD90019C2997B3\"\r\nedr_machine_id                              : \"b3da4e2d293fcb8498c80a680307efe87e2e15d1\"\r\nconflicting_applications                    : []\r\nnetwork_protection_status                   : \"stopped\"\r\nnetwork_protection_enforcement_level        : \"disabled\"\r\ntroubleshooting_mode                        : false"
            },
            {
              "Type": "Note",
              "Value": "Note the org_id is now populated and healthy is true."
            },
            {
              "Type": "Description",
              "Value": "You can also check the Security Portal to see if the device is reporting in. https://security.microsoft.com/machines"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/SecurityPortalFedora.png"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "MDELinuxIPTables", "path": "./json/MDELinuxIPTables.json", "data": {
  "title": "RHEL iptables",
  "path": "/mde/linux-rhel-iptables",
  "section": "MDE",
  "subSection": "Linux",
  "description": "Use the guide to troubleshoot issues with MDE connectivity to the Microsoft cloud service endpoints. We will use iptables to block and then allow outbound traffic to the MDE endpoints so we can see what errors and logs occur.",
  "data": [
    {
      "section": 1,
      "title": "Check iptables rules",
      "description": "Allow MDE to communicate with the Microsoft cloud service endpoints.",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "List iptables IPv4 rules"
            },
            {
              "Type": "Code",
              "Value": "sudo iptables -S"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Command output"
            },
            {
              "Type": "Description",
              "Value": "The output shows the current iptables rules. The -S option is used to list the rules in a format that can be used as input to iptables-restore."
            },
            {
              "Type": "Code",
              "Value": "-P INPUT ACCEPT\r\n-P FORWARD ACCEPT\r\n-P OUTPUT ACCEPT"
            },
            {
              "Type": "Note",
              "Value": "The above output shows that the default policy for the INPUT, FORWARD and OUTPUT chains is ACCEPT."
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Optional: Block outbound traffic",
      "description": "Block all outbound traffic.",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Test outbound connection with curl works successfully"
            },
            {
              "Type": "Code",
              "Value": "curl google.com"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Successful curl output"
            },
            {
              "Type": "Code",
              "Value": "<HTML><HEAD><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">\r\n<TITLE>301 Moved</TITLE></HEAD><BODY>\r\n<H1>301 Moved</H1>\r\nThe document has moved\r\n<A HREF=\"http://www.google.com/\">here</A>.\r\n</BODY></HTML>"
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Block all outbound traffic"
            },
            {
              "Type": "Code",
              "Value": "sudo iptables -A OUTPUT -p tcp -m multiport --dport 80,443 -j REJECT"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Description",
              "Value": "Our iptables rule was applied, we can check by viewing the rules again."
            },
            {
              "Type": "Code",
              "Value": "sudo iptables -L"
            },
            {
              "Type": "Description",
              "Value": "Output of iptables rules"
            },
            {
              "Type": "Code",
              "Value": "Chain INPUT (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain FORWARD (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain OUTPUT (policy ACCEPT)\r\ntarget     prot opt source               destination\r\nREJECT     tcp  --  anywhere             anywhere             multiport dports http,https reject-with icmp-port-unreachable"
            },
            {
              "Type": "Description",
              "Value": "Any subsequent curl commands on port 80 and 443 will fail."
            }
          ]
        },
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Test outbound connection with curl is blocked successfully"
            },
            {
              "Type": "Code",
              "Value": "curl google.com"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Blocked curl output"
            },
            {
              "Type": "Code",
              "Value": "curl: (28) Failed to connect to google.com port 80: Connection timed out"
            },
            {
              "Type": "Description",
              "Value": "The above output shows that the connection timed out, which means the outbound traffic was blocked."
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Connectivity Test",
      "description": "Check MDATP connectivity to the Microsoft cloud service endpoints.",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check MDATP connectivity to the Microsoft cloud service endpoints."
            },
            {
              "Type": "Description",
              "Value": "mdatp has a built-in connectivity test that can be used to check connectivity to the Microsoft cloud service endpoints."
            },
            {
              "Type": "Code",
              "Value": "mdatp connectivity test"
            },
            {
              "Type": "Note",
              "Value": "The connectivity test will take a few minutes to complete."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "ERROR Connectivity Test failed"
            },
            {
              "Type": "Code",
              "Value": "Testing connection with https://nf.smartscreen.microsoft.com/api/network/mac ... [ERROR]\r\n        [\"(request #16)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://unitedstates.x.cp.wd.microsoft.com/api/report ... [ERROR]\r\n        [\"(request #19)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://ussus1eastprod.blob.core.windows.net/ ... [ERROR]\r\n        [\"(request #22)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://ussus1westprod.blob.core.windows.net/ ... [ERROR]\r\n        [\"(request #25)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://unitedstates.smartscreen.microsoft.com//api/network/mac ... [ERROR]\r\n        [\"(request #28)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://unitedstates.smartscreen-prod.microsoft.com//api/network/mac ... [ERROR]\r\n        [\"(request #32)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://go.microsoft.com/fwlink/?linkid=2144709 ... [ERROR]\r\n        [\"(request #35)\",\"Network is down\"]\r\n        Network is down (error code 100)\r\nTesting connection with https://winatp-gw-cus.microsoft.com/test ... [ERROR]\r\n        Timeout was reached\r\n        HTTP response: 0\r\nTesting connection with https://winatp-gw-eus.microsoft.com/test ... [ERROR]\r\n        Timeout was reached\r\n        HTTP response: 0\r\nTesting connection with https://us-v20.events.data.microsoft.com/ping ... [ERROR]\r\n        Timeout was reached\r\n        HTTP response: 0\r\nTesting connection with https://automatedirstrprdcus.blob.core.windows.net ... [ERROR]\r\n        Timeout was reached\r\n        HTTP response: 0\r\nTesting connection with https://automatedirstrprdeus.blob.core.windows.net ... [ERROR]\r\n        Timeout was reached\r\n        HTTP response: 0"
            }
          ]
        }
      ]
    },
    {
      "section": 4,
      "description": "",
      "title": "Allow MDE outbound traffic",
      "tasks": [
        {
          "title": "Allow outbound traffic",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Allow outbound traffic to MDE endpoints"
            },
            {
              "Type": "Description",
              "Value": "From our test above we can see which endpoints are blocked."
            },
            {
              "Type": "Description",
              "Value": "You should always refer to the official documentation for the latest list of endpoints. https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide#network-connections"
            },
            {
              "Type": "Note",
              "Value": "For the purpose of this lab we will allow only the endpoints identified in the previous step."
            },
            {
              "Type": "Title",
              "Value": "Allow outbound traffic to the Microsoft cloud service endpoints."
            },
            {
              "Type": "Code",
              "Value": "iptables -I OUTPUT -d nf.smartscreen.microsoft.com,unitedstates.x.cp.wd.microsoft.com,ussus1eastprod.blob.core.windows.net,ussus1westprod.blob.core.windows.net,unitedstates.smartscreen.microsoft.com,unitedstates.smartscreen-prod.microsoft.com,go.microsoft.com,winatp-gw-cus.microsoft.com,winatp-gw-eus.microsoft.com,us-v20.events.data.microsoft.com,automatedirstrprdcus.blob.core.windows.net,automatedirstrprdeus.blob.core.windows.net -p tcp --dport 443 -j ACCEPT"
            },
            {
              "Type": "Note",
              "Value": "This is for demonstration purposes only. Using domain/host name in iptables rules is not recommended. You should always use IP addresses."
            },
            {
              "Type": "Note",
              "Value": "When iptables applies to rule above  it evaluates the domain name and resolves it to an IP address. If the IP address changes, the rule will no longer work. You will need to update the rule with the new IP address."
            },
            {
              "Type": "Note",
              "Value": "If we perform multiple nslookups against nf.smartscreen.microsoft.com we can see that the IP address changes."
            },
            {
              "Type": "Code",
              "Value": "Non-authoritative answer:\r\nnf.smartscreen.microsoft.com    canonical name = wd-prod-ss.trafficmanager.net.\r\nwd-prod-ss.trafficmanager.net   canonical name = wd-prod-ss-us-east-2-fe.eastus.cloudapp.azure.com.\r\nName:   wd-prod-ss-us-east-2-fe.eastus.cloudapp.azure.com\r\nAddress: 20.246.247.192\r\n\r\nNon-authoritative answer:\r\nnf.smartscreen.microsoft.com    canonical name = wd-prod-ss.trafficmanager.net.\r\nwd-prod-ss.trafficmanager.net   canonical name = wd-prod-ss-us-east-2-fe.eastus.cloudapp.azure.com.\r\nName:   wd-prod-ss-us-east-2-fe.eastus.cloudapp.azure.com\r\nAddress: 20.246.247.192\r\n\r\nNon-authoritative answer:\r\nnf.smartscreen.microsoft.com    canonical name = wd-prod-ss.trafficmanager.net.\r\nwd-prod-ss.trafficmanager.net   canonical name = wd-prod-ss-us-northcentral-2-fe.northcentralus.cloudapp.azure.com.\r\nName:   wd-prod-ss-us-northcentral-2-fe.northcentralus.cloudapp.azure.com\r\nAddress: 52.159.118.63"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Check iptables rules"
            },
            {
              "Type": "Code",
              "Value": "sudo iptables -L"
            },
            {
              "Type": "Code",
              "Value": "Chain INPUT (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain FORWARD (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain OUTPUT (policy ACCEPT)\r\ntarget     prot opt source               destination\r\nACCEPT     tcp  --  anywhere             20.60.88.36          tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.38.122.100        tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.189.173.15        tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.22.154.109        tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.37.135.94         tcp dpt:https\r\nACCEPT     tcp  --  anywhere             a104-117-234-151.deploy.static.akamaitechnologies.com  tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.98.40.52          tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.98.40.52          tcp dpt:https\r\nACCEPT     tcp  --  anywhere             52.239.160.170       tcp dpt:https\r\nACCEPT     tcp  --  anywhere             52.240.48.36         tcp dpt:https\r\nACCEPT     tcp  --  anywhere             20.49.104.18         tcp dpt:https\r\nACCEPT     tcp  --  anywhere             168.61.21.91         tcp dpt:https\r\nREJECT     tcp  --  anywhere             anywhere             multiport dports http,https reject-with icmp-port-unreachable"
            },
            {
              "Type": "Description",
              "Value": "Our iptables rules were applied, we can see the specific IP address for each endpoint at the time iptables resolved the domain name."
            }
          ]
        }
      ]
    },
    {
      "section": 5,
      "description": "",
      "title": "Connectivity Test",
      "tasks": [
        {
          "title": "Connectivity Test",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Connectivity Test"
            },
            {
              "Type": "Description",
              "Value": "Now that we have allowed outbound traffic to the Microsoft cloud service endpoints, we can run the connectivity test again."
            },
            {
              "Type": "Code",
              "Value": "mdatp connectivity test"
            },
            {
              "Type": "Note",
              "Value": "The connectivity test may take a few minutes to complete."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Connectivity...sometimes!"
            },
            {
              "Type": "Code",
              "Value": "Testing connection with https://nf.smartscreen.microsoft.com/api/network/mac ... [ERROR]\r\n        [\"(request #182)\",\"Failed to connect to any resolved endpoint\"]\r\n        Unknown error -1 (error code -1)\r\nTesting connection with https://unitedstates.x.cp.wd.microsoft.com/api/report ... [OK]\r\nTesting connection with https://ussus1eastprod.blob.core.windows.net/ ... [OK]\r\nTesting connection with https://ussus1westprod.blob.core.windows.net/ ... [OK]\r\nTesting connection with https://unitedstates.smartscreen.microsoft.com//api/network/mac ... [OK]\r\nTesting connection with https://unitedstates.smartscreen-prod.microsoft.com//api/network/mac ... [OK]\r\nTesting connection with https://go.microsoft.com/fwlink/?linkid=2144709 ... [ERROR]\r\n        [\"(request #191)\",\"Failed to connect to any resolved endpoint\"]\r\n        Unknown error -1 (error code -1)\r\nTesting connection with https://winatp-gw-cus.microsoft.com/test ... [ERROR]\r\n        Couldn't connect to server\r\n        HTTP response: 0\r\nTesting connection with https://winatp-gw-eus.microsoft.com/test ... [ERROR]\r\n        Couldn't connect to server\r\n        HTTP response: 0\r\nTesting connection with https://us-v20.events.data.microsoft.com/ping ... [ERROR]\r\n        Couldn't connect to server\r\n        HTTP response: 0\r\nTesting connection with https://automatedirstrprdcus.blob.core.windows.net ... [OK]\r\nTesting connection with https://automatedirstrprdeus.blob.core.windows.net ... [OK]"
            },
            {
              "Type": "Description",
              "Value": "Most of our endpoints succed while some do not. This is because the IP address for those endpoints have changed since we added them to our iptables rule."
            },
            {
              "Type": "Note",
              "Value": "For production environments it's best to use a proxy or firewall that can allow outbound traffic to the Microsoft cloud service URL endpoints."
            }
          ]
        }
      ]
    },
    {
      "section": 6,
      "description": "",
      "title": "Allow all outbound traffic",
      "tasks": [
        {
          "title": "Allow all outbound traffic",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Allow all outbound traffic"
            },
            {
              "Type": "Description",
              "Value": "Let's remove the iptables rules and allow all outbound traffic."
            },
            {
              "Type": "Code",
              "Value": "iptables -F"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Check our iptables rules"
            },
            {
              "Type": "Code",
              "Value": "iptables -L"
            },
            {
              "Type": "Code",
              "Value": "Chain INPUT (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain FORWARD (policy ACCEPT)\r\ntarget     prot opt source               destination\r\n\r\nChain OUTPUT (policy ACCEPT)\r\ntarget     prot opt source               destination"
            }
          ]
        }
      ]
    },
    {
      "section": 7,
      "description": "",
      "title": "Connectivity Test",
      "tasks": [
        {
          "title": "Connectivity Test",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Connectivity Test"
            },
            {
              "Type": "Code",
              "Value": "mdatp connectivity test"
            },
            {
              "Type": "Note",
              "Value": "The connectivity test may take a few minutes to complete."
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Success!"
            },
            {
              "Type": "Code",
              "Value": "Testing connection with https://nf.smartscreen.microsoft.com/api/network/mac ... [OK]\r\nTesting connection with https://unitedstates.x.cp.wd.microsoft.com/api/report ... [OK]\r\nTesting connection with https://ussus1eastprod.blob.core.windows.net/ ... [OK]\r\nTesting connection with https://ussus1westprod.blob.core.windows.net/ ... [OK]\r\nTesting connection with https://unitedstates.smartscreen.microsoft.com//api/network/mac ... [OK]\r\nTesting connection with https://unitedstates.smartscreen-prod.microsoft.com//api/network/mac ... [OK]\r\nTesting connection with https://go.microsoft.com/fwlink/?linkid=2144709 ... [OK]\r\nTesting connection with https://winatp-gw-cus.microsoft.com/test ... [OK]\r\nTesting connection with https://winatp-gw-eus.microsoft.com/test ... [OK]\r\nTesting connection with https://us-v20.events.data.microsoft.com/ping ... [OK]\r\nTesting connection with https://automatedirstrprdcus.blob.core.windows.net ... [OK]\r\nTesting connection with https://automatedirstrprdeus.blob.core.windows.net ... [OK]"
            }
          ]
        }
      ]
    }
  ]
}},
 { "file": "MDELinuxOracleKernelUpdate", "path": "./json/MDELinuxOracleKernelUpdate.json", "data": {
  "title": "Oracle Kernel Update",
  "path": "/mde/linux-oracle-kernel-update",
  "section": "MDE",
  "subSection": "Linux",
  "description": "",
  "data": [
    {
      "section": 1,
      "title": "View recommendations",
      "description": "View recommendations from the Microsoft 365 Defender portal",
      "tasks": [
        {
          "title": "",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Review recommendations"
            },
            {
              "Type": "Description",
              "Value": "Navigate to https://security.microsoft.com/security-recommendations and review the recommendations for your environment."
            },
            {
              "Type": "Image",
              "Value": "/images/nll/oracle/VulnerabilityManagement-Recommendations.png"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "What is the security portal doing?"
            },
            {
              "Type": "Description",
              "Value": "The Microsoft 365 Defender portal is analyzing your environment and providing recommendations based on the security posture of your environment."
            }
          ]
        },
        {
          "title": "Select a recommendation to review",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Select a recommendation to review"
            },
            {
              "Type": "Description",
              "Value": "In this scenario we are reviewing teh Update Oracle Kernel-uek for Linux"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/oracle/VulnerabilityManagement-Recommendations-OracleKernel.png"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "What's does the portal show us?"
            },
            {
              "Type": "Description",
              "Value": "The portal advises us to update the kerel, it shows the list of exposed/installed devices, and any associated CVEs related to this vulnerability."
            },
            {
              "Type": "Image",
              "Value": "/images/nll/oracle/VulnerabilityManagement-Recommendations-OracleCVE-1.png"
            },
            {
              "Type": "Description",
              "Value": "We can also see the list of CVEs associated with this vulnerability."
            }
          ]
        }
      ]
    },
    {
      "section": 2,
      "title": "Update the kernel",
      "description": "Update the kernel on the Oracle Linux server",
      "tasks": [
        {
          "title": "What's the current kernel version?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check the current kernel version"
            },
            {
              "Type": "Code",
              "Value": "sudo uname -r"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "5.4.16-2136.322.6.2.el8uek.x86_64"
            }
          ]
        },
        {
          "title": "How do we fix this?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Update the Oracle Kernel"
            },
            {
              "Type": "Description",
              "Value": "One method is to update the kernel using uptrack. This allows us to update the kernel without rebooting the server."
            },
            {
              "Type": "Code",
              "Value": "uptrack-upgrade -y"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Image",
              "Value": "/images/nll/oracle/VulnerabilityManagement-Recommendations-OracleCVE-2.png"
            },
            {
              "Type": "Description",
              "Value": "The output shows the kernel being updated. It displays CVE that are being addressed, and the kernel version being installed."
            }
          ]
        },
        {
          "title": "How do we fix this?",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Update the Oracle Kernel"
            },
            {
              "Type": "Description",
              "Value": "Another method is to use dnf upgrade."
            },
            {
              "Type": "Code",
              "Value": "sudo dnf upgrade"
            },
            {
              "Type": "Description",
              "Value": "Reboot the server to complete the kernel update."
            },
            {
              "Type": "Code",
              "Value": "sudo reboot"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "Last metadata expiration check: 4:03:15 ago on Wed 20 Sep 2023 02:53:25 PM UTC.\r\nDependencies resolved.\r\n============================================================================================================================================================================================\r\n Package                                 Architecture                     Version                                               Repository                                             Size\r\n============================================================================================================================================================================================\r\nUpgrading:\r\n dmidecode                               x86_64                           1:3.3-4.el8_8.1                                       ol8_baseos_latest                                      92 k\r\n libgcc                                  x86_64                           8.5.0-18.0.5.el8                                      ol8_baseos_latest                                      91 k\r\n libgomp                                 x86_64                           8.5.0-18.0.5.el8                                      ol8_baseos_latest                                     217 k\r\n libstdc++                               x86_64                           8.5.0-18.0.5.el8                                      ol8_baseos_latest                                     463 k\r\n mdatp                                   x86_64                           101.23072.0021-1                                      packages-microsoft-com-prod                           127 M\r\n microcode_ctl                           x86_64                           4:20230808-2.0.1.el8                                  ol8_baseos_latest                                     8.1 M\r\nInstalling group/module packages:\r\n kernel-uek                              x86_64                           5.4.17-2136.323.8.1.el8uek                            ol8_UEKR6                                             114 M\r\n\r\nTransaction Summary\r\n============================================================================================================================================================================================\r\nInstall  1 Package\r\nUpgrade  6 Packages\r\n\r\nTotal download size: 250 M"
            },
            {
              "Type": "Code",
              "Value": "Is this ok [y/N]: y\r\nDownloading Packages:\r\n(1/7): dmidecode-3.3-4.el8_8.1.x86_64.rpm                                                                                                                   809 kB/s |  92 kB     00:00\r\n(2/7): libgcc-8.5.0-18.0.5.el8.x86_64.rpm                                                                                                                   719 kB/s |  91 kB     00:00\r\n(3/7): libgomp-8.5.0-18.0.5.el8.x86_64.rpm                                                                                                                  7.8 MB/s | 217 kB     00:00\r\n(4/7): libstdc++-8.5.0-18.0.5.el8.x86_64.rpm                                                                                                                 13 MB/s | 463 kB     00:00\r\n(5/7): microcode_ctl-20230808-2.0.1.el8.x86_64.rpm                                                                                                           43 MB/s | 8.1 MB     00:00\r\n(6/7): kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64.rpm                                                                                                      21 MB/s | 114 MB     00:05\r\n(7/7): mdatp_101.23072.0021.x86_64.rpm                                                                                                                       20 MB/s | 127 MB     00:06\r\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nTotal                                                                                                                                                        38 MB/s | 250 MB     00:06\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                      1/1\r\n  Preparing        :                                                                                                                                                                    1/1\r\n  Running scriptlet: libgcc-8.5.0-18.0.5.el8.x86_64                                                                                                                                     1/1\r\n  Upgrading        : libgcc-8.5.0-18.0.5.el8.x86_64                                                                                                                                    1/13\r\n  Running scriptlet: libgcc-8.5.0-18.0.5.el8.x86_64                                                                                                                                    1/13\r\n  Upgrading        : libstdc++-8.5.0-18.0.5.el8.x86_64                                                                                                                                 2/13\r\n  Running scriptlet: libstdc++-8.5.0-18.0.5.el8.x86_64                                                                                                                                 2/13\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                     3/13\r\n  Upgrading        : mdatp-101.23072.0021-1.x86_64                                                                                                                                     3/13\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                     3/13\r\n\r\n  Upgrading        : microcode_ctl-4:20230808-2.0.1.el8.x86_64                                                                                                                         4/13\r\n  Running scriptlet: microcode_ctl-4:20230808-2.0.1.el8.x86_64                                                                                                                         4/13\r\n  Upgrading        : libgomp-8.5.0-18.0.5.el8.x86_64                                                                                                                                   5/13\r\n  Running scriptlet: libgomp-8.5.0-18.0.5.el8.x86_64                                                                                                                                   5/13\r\n  Upgrading        : dmidecode-1:3.3-4.el8_8.1.x86_64                                                                                                                                  6/13\r\n  Running scriptlet: kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64                                                                                                                      7/13\r\n  Installing       : kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64                                                                                                                      7/13\r\n  Running scriptlet: kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64                                                                                                                      7/13\r\n  Cleanup          : libstdc++-8.5.0-18.0.2.el8.x86_64                                                                                                                                 8/13\r\n  Running scriptlet: libstdc++-8.5.0-18.0.2.el8.x86_64                                                                                                                                 8/13\r\n  Running scriptlet: microcode_ctl-4:20230214-2.0.3.el8.x86_64                                                                                                                         9/13\r\n  Cleanup          : microcode_ctl-4:20230214-2.0.3.el8.x86_64                                                                                                                         9/13\r\n  Running scriptlet: microcode_ctl-4:20230214-2.0.3.el8.x86_64                                                                                                                         9/13\r\n  Cleanup          : libgcc-8.5.0-18.0.2.el8.x86_64                                                                                                                                   10/13\r\n  Running scriptlet: libgcc-8.5.0-18.0.2.el8.x86_64                                                                                                                                   10/13\r\n  Running scriptlet: mdatp-101.23062.0010-1.x86_64                                                                                                                                    11/13\r\n  Cleanup          : mdatp-101.23062.0010-1.x86_64                                                                                                                                    11/13\r\n  Running scriptlet: mdatp-101.23062.0010-1.x86_64                                                                                                                                    11/13\r\n  Running scriptlet: libgomp-8.5.0-18.0.2.el8.x86_64                                                                                                                                  12/13\r\n  Cleanup          : libgomp-8.5.0-18.0.2.el8.x86_64                                                                                                                                  12/13\r\n  Running scriptlet: libgomp-8.5.0-18.0.2.el8.x86_64                                                                                                                                  12/13\r\n  Cleanup          : dmidecode-1:3.3-4.el8.x86_64                                                                                                                                     13/13\r\n  Running scriptlet: mdatp-101.23072.0021-1.x86_64                                                                                                                                    13/13\r\n  Running scriptlet: microcode_ctl-4:20230808-2.0.1.el8.x86_64                                                                                                                        13/13\r\n  Running scriptlet: kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64                                                                                                                     13/13\r\n  Running scriptlet: dmidecode-1:3.3-4.el8.x86_64                                                                                                                                     13/13\r\n  Verifying        : kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64                                                                                                                      1/13\r\n  Verifying        : dmidecode-1:3.3-4.el8_8.1.x86_64                                                                                                                                  2/13\r\n  Verifying        : dmidecode-1:3.3-4.el8.x86_64                                                                                                                                      3/13\r\n  Verifying        : libgcc-8.5.0-18.0.5.el8.x86_64                                                                                                                                    4/13\r\n  Verifying        : libgcc-8.5.0-18.0.2.el8.x86_64                                                                                                                                    5/13\r\n  Verifying        : libgomp-8.5.0-18.0.5.el8.x86_64                                                                                                                                   6/13\r\n  Verifying        : libgomp-8.5.0-18.0.2.el8.x86_64                                                                                                                                   7/13\r\n  Verifying        : libstdc++-8.5.0-18.0.5.el8.x86_64                                                                                                                                 8/13\r\n  Verifying        : libstdc++-8.5.0-18.0.2.el8.x86_64                                                                                                                                 9/13\r\n  Verifying        : microcode_ctl-4:20230808-2.0.1.el8.x86_64                                                                                                                        10/13\r\n  Verifying        : microcode_ctl-4:20230214-2.0.3.el8.x86_64                                                                                                                        11/13\r\n  Verifying        : mdatp-101.23072.0021-1.x86_64                                                                                                                                    12/13\r\n  Verifying        : mdatp-101.23062.0010-1.x86_64                                                                                                                                    13/13\r\n\r\nUpgraded:\r\n  dmidecode-1:3.3-4.el8_8.1.x86_64             libgcc-8.5.0-18.0.5.el8.x86_64    libgomp-8.5.0-18.0.5.el8.x86_64    libstdc++-8.5.0-18.0.5.el8.x86_64    mdatp-101.23072.0021-1.x86_64\r\n  microcode_ctl-4:20230808-2.0.1.el8.x86_64\r\nInstalled:\r\n  kernel-uek-5.4.17-2136.323.8.1.el8uek.x86_64\r\n\r\nComplete!"
            }
          ]
        },
        {
          "title": "Confirm the kernel version",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check the new kernel version"
            },
            {
              "Type": "Code",
              "Value": "sudo uname -r"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "Sample output"
            },
            {
              "Type": "Code",
              "Value": "5.4.17-2136.322.6.2.el8uek.x86_64"
            }
          ]
        }
      ]
    },
    {
      "section": 3,
      "title": "Check the Security Portal",
      "description": "Check the Microsoft 365 Defender portal for updates",
      "tasks": [
        {
          "title": "Check the Security Portal",
          "userActivity": [
            {
              "Type": "Title",
              "Value": "Check the Security Portal"
            },
            {
              "Type": "Description",
              "Value": "Navigate back to the Microsoft 365 Defender portal and review the recommendations."
            },
            {
              "Type": "Note",
              "Value": "The portal will take some time to update depending on how often the agent reports back to the MDE service."
            },
            {
              "Type": "Image",
              "Value": "/images/nll/oracle/VulnerabilityManagement-Recommendations-OracleCVE-3.png"
            }
          ],
          "backgroundActivity": [
            {
              "Type": "Title",
              "Value": "What's does the portal show us?"
            },

            {
              "Type": "Description",
              "Value": "The portal shows that the Oracle Kernel has been updated, and the CVEs have been addressed."
            }
          ]
        }
      ]
    }
  ]
}}
]
